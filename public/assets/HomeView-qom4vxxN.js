import{g as J,a as ee,b as te,N as se,f as re,c as le,_ as H,d as ae,u as ne}from"./_plugin-vue_export-helper-BhSrxepO.js";import{a as A,u as ie,b as oe}from"./vendor-primevue-Bo0b_ULt.js";import{Q as E,c as n,d as s,s as b,e as l,t as p,z as C,q,h as T,y,F as $,E as S,G as ce,v as I,L as B,p as j,x as ue,r as R,o as de}from"./vendor-vue-Bq-k71LZ.js";const me={class:"text-center space-y-4"},fe={key:0,class:"space-y-2"},ge={key:1,class:"text-4xl font-bold text-gray-900"},pe={key:2,class:"space-y-2"},he={key:3,class:"text-lg text-gray-600 max-w-2xl mx-auto"},be={class:"flex justify-end gap-4 flex-wrap"},xe={__name:"HeaderView",props:{loading:{type:Boolean,default:!1},databaseTitle:{type:String,default:""},databaseDescription:{type:String,default:""}},emits:["refreshSchema"],setup(e,{emit:t}){const a=E(),u=t,o=()=>{u("refreshSchema")},g=()=>{a.push("/add")};return(m,f)=>{const w=A;return s(),n("div",me,[e.loading&&!e.databaseTitle?(s(),n("div",fe,f[0]||(f[0]=[l("div",{class:"h-12 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"300px"}},null,-1)]))):(s(),n("h1",ge,p(e.databaseTitle),1)),e.loading&&!e.databaseDescription?(s(),n("div",pe,f[1]||(f[1]=[l("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"500px"}},null,-1),l("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"400px"}},null,-1)]))):e.databaseDescription?(s(),n("p",he,p(e.databaseDescription),1)):b("",!0),l("div",be,[C(w,{onClick:o,disabled:e.loading,severity:"secondary"},{default:q(()=>f[2]||(f[2]=[l("i",{class:"pi pi-refresh"},null,-1),T("Refresh ",-1)])),_:1,__:[2]},8,["disabled"]),C(w,{onClick:g,severity:"primary"},{default:q(()=>f[3]||(f[3]=[l("i",{class:"pi pi-plus"},null,-1),T("Add ",-1)])),_:1,__:[3]})])])}}},ye={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3"},ve={class:"flex-1"},_e={class:"text-red-700"},we={__name:"ErrorDisplay",props:{error:{type:String,default:""}},emits:["retry"],setup(e){return(t,a)=>{const u=A;return e.error?(s(),n("div",ye,[a[2]||(a[2]=l("i",{class:"pi pi-exclamation-triangle text-red-500 text-xl"},null,-1)),l("div",ve,[a[1]||(a[1]=l("strong",{class:"text-red-800"},"Error:",-1)),l("span",_e,p(e.error),1),C(u,{onClick:t.retry,severity:"danger",text:""},{default:q(()=>a[0]||(a[0]=[T(" Try Again ",-1)])),_:1,__:[0]},8,["onClick"])])])):b("",!0)}}},Fe={class:"text-center"},$e={key:0},Se={key:1},Ce={__name:"LoadMoreButton",props:{loading:{type:Boolean,default:!1}},emits:["load-more"],setup(e){return(t,a)=>{const u=A;return s(),n("div",Fe,[C(u,{onClick:a[0]||(a[0]=o=>t.$emit("load-more")),disabled:e.loading,severity:"secondary"},{default:q(()=>[e.loading?(s(),n("span",$e,"Loading...")):(s(),n("span",Se,"Load More"))]),_:1},8,["disabled"])])}}},ke={class:"text-gray-800 leading-relaxed"},je={__name:"RichTextField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=e,a=y(()=>Array.isArray(t.value)?t.value:t.value&&typeof t.value=="object"?t.value.rich_text||t.value.title||[]:typeof t.value=="string"?[{text:{content:t.value},annotations:{}}]:[]),u=o=>{if(!o)return{};const g={};return o.italic&&(g.fontStyle="italic"),o.underline&&(g.textDecoration="underline"),o.strikethrough&&(g.textDecoration="line-through"),o.code&&(g.fontFamily="monospace",g.backgroundColor="#f3f4f6",g.padding="2px 4px",g.borderRadius="4px"),g};return(o,g)=>(s(),n("div",ke,[(s(!0),n($,null,S(a.value,(m,f)=>(s(),n("span",{key:f,class:I(m.annotations?.bold?"font-semibold":""),style:ce(u(m.annotations))},p(m.text?.content||m.plain_text||""),7))),128))]))}},Ie={class:"grid grid-cols-2 gap-4"},Le={key:0,class:"flex items-center space-x-2"},Ne={class:"text-gray-800"},De={key:1,class:"flex items-center space-x-2"},Oe={class:"text-gray-800"},qe={__name:"ContactField",props:{value:{type:[Object,String],required:!0}},setup(e){return(t,a)=>(s(),n("div",Ie,[typeof e.value=="string"||e.value?.email?(s(),n("div",Le,[a[0]||(a[0]=l("i",{class:"pi pi-envelope text-blue-500"},null,-1)),l("span",Ne,p(typeof e.value=="string"?e.value:e.value.email),1)])):b("",!0),typeof e.value=="string"||e.value?.phone?(s(),n("div",De,[a[1]||(a[1]=l("i",{class:"pi pi-phone text-green-500"},null,-1)),l("span",Oe,p(typeof e.value=="string"?e.value:e.value.phone),1)])):b("",!0)]))}},Be={class:"space-y-3"},Ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Me={class:"text-sm font-medium text-gray-700"},Re={class:"flex items-center space-x-2"},Te={class:"text-gray-800 font-mono font-medium"},Pe={key:0,class:"text-lg text-gray-600 font-medium"},Ue={__name:"NumbersField",props:{value:{type:Object,required:!0},schema:{type:Object,default:null},formatLabel:{type:Function,required:!0},formatNumber:{type:Function,required:!0},getSchemaProperty:{type:Function,required:!0},getFieldCurrencySymbol:{type:Function,required:!0}},setup(e){return(t,a)=>(s(),n("div",Be,[l("div",Ae,[(s(!0),n($,null,S(e.value,(u,o)=>(s(),n("div",{key:o,class:"flex items-center justify-start bg-gray-50 rounded-lg gap-2 p-2"},[l("i",{class:I([B(J)(o,e.getSchemaProperty(o)),"text-blue-500"])},null,2),l("span",Me,p(e.formatLabel(o)),1),l("div",Re,[l("span",Te,p(e.formatNumber(u||0,o)),1),e.getFieldCurrencySymbol(o)?(s(),n("span",Pe,p(e.getFieldCurrencySymbol(o)),1)):b("",!0)])]))),128))])]))}},Ve={class:"flex items-center space-x-2"},ze=["href"],Ee={__name:"UrlField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=a=>{try{const u=new URL(a);return u.hostname+u.pathname}catch{return a}};return(a,u)=>(s(),n("div",Ve,[u[0]||(u[0]=l("i",{class:"pi pi-link text-purple-500"},null,-1)),l("a",{href:typeof e.value=="string"?e.value:e.value.url,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline truncate max-w-xs"},p(t(typeof e.value=="string"?e.value:e.value.url)),9,ze)]))}},He={class:"flex items-center space-x-2"},Ge={class:"text-gray-800"},Qe={__name:"DateField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=a=>a?new Date(a).toLocaleDateString():"";return(a,u)=>(s(),n("div",He,[u[0]||(u[0]=l("i",{class:"pi pi-calendar text-indigo-500"},null,-1)),l("span",Ge,p(t(typeof e.value=="string"?e.value:e.value.date?.start||e.value.date)),1)]))}},We={class:"flex flex-wrap gap-2"},Je={__name:"SelectField",props:{value:{type:[Object,Array],required:!0},fieldName:{type:String,required:!0},schema:{type:Object,default:null}},setup(e){const t=e,a=y(()=>({name:t.fieldName,options:o(t.fieldName,t.schema)})),u=y(()=>typeof t.value=="string"&&t.value.trim()?[{value:t.value,label:t.value,name:t.value}]:Array.isArray(t.value)&&t.value.length>0?t.value.map(g=>({value:g,label:g,name:g})):ee(t.value)),o=(g,m)=>!m||!m.properties||!m.properties[g]?[]:m.properties[g].options||[];return(g,m)=>(s(),n("div",We,[(s(!0),n($,null,S(u.value,f=>(s(),n("span",{key:f.value||f,class:I([B(te)(f,a.value,e.schema),"px-3 py-1.5 text-sm rounded-full border font-medium"])},p(f.label||f),3))),128))]))}},Ke={class:"flex items-center gap-2"},Xe={key:0,class:"flex items-center gap-1 bg-green-500 text-white px-2 py-1 rounded-full text-sm"},Ye={class:"font-medium"},Ze={key:1,class:"flex items-center gap-1 bg-gray-200 text-gray-600 px-2 py-1 rounded-full text-sm"},et={class:"font-medium"},G={__name:"BooleanField",props:{value:{type:Boolean,required:!0},fieldName:{type:String,required:!0},formatLabel:{type:Function,required:!0}},setup(e){return(t,a)=>(s(),n("div",Ke,[e.value?(s(),n("div",Xe,[a[0]||(a[0]=l("i",{class:"pi pi-check-circle"},null,-1)),l("span",Ye,p(e.formatLabel(e.fieldName)),1)])):(s(),n("div",Ze,[a[1]||(a[1]=l("i",{class:"pi pi-times-circle"},null,-1)),l("span",et,p(e.formatLabel(e.fieldName)),1)]))]))}},tt={class:"text-gray-800 leading-relaxed"},Q={__name:"TextField",props:{value:{type:[String,Number],required:!0}},setup(e){return(t,a)=>(s(),n("div",tt,p(e.value),1))}};function st(e="primary",t="small",a=!1){return{buttonPT:y(()=>({root:{class:[rt(t),lt(e),"rounded-lg flex items-center justify-center","transition-all duration-300 hover:scale-105 hover:-translate-y-0.5","shadow-lg hover:shadow-xl","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed","!border-0"]},icon:{class:a?"m-0":"mr-2"},label:{class:"font-medium"}}))}}function rt(e){const t={small:"px-3 py-1.5 text-sm",large:"px-6 py-3 text-lg",default:"px-4 py-2"};return t[e]||t.default}function lt(e){const t={primary:"!bg-blue-600 !hover:bg-blue-700 !text-white focus:ring-blue-500 hover:shadow-[0_20px_40px_rgba(37,99,235,0.3),0_0_20px_rgba(37,99,235,0.2)]",secondary:"!bg-gray-200 !hover:bg-gray-300 !text-gray-700 hover:text-gray-800 border border-gray-300 focus:ring-gray-500 hover:shadow-[0_20px_40px_rgba(107,114,128,0.3),0_0_20px_rgba(107,114,128,0.2)]",danger:"!bg-red-600 !hover:bg-red-700 !text-white focus:ring-red-500 hover:shadow-[0_20px_40px_rgba(239,68,68,0.3),0_0_20px_rgba(239,68,68,0.2)]",success:"!bg-green-600 !hover:bg-green-700 !text-white focus:ring-green-500 hover:shadow-[0_20px_40px_#22c55e4d,0_0_20px_#22c55e33]",warning:"!bg-amber-600 !hover:bg-amber-700 !text-white focus:ring-amber-500 hover:shadow-[0_20px_40px_rgba(217,119,6,0.3),0_0_20px_rgba(217,119,6,0.2)]",info:"!bg-cyan-600 !hover:bg-cyan-700 !text-white focus:ring-cyan-500 hover:shadow-[0_20px_40px_rgba(6,182,212,0.3),0_0_20px_rgba(6,182,212,0.2)]"};return t[e]||t.primary}const W={__name:"IconButton",props:{icon:{type:String,required:!0},severity:{type:String,default:"primary"},size:{type:String,default:"small"}},emits:["click"],setup(e,{emit:t}){const a=e,{buttonPT:u}=st(a.severity,a.size,!0),o=t,g=()=>{o("click")};return(m,f)=>{const w=A;return s(),j(w,{pt:B(u),icon:e.icon,onClick:g},null,8,["pt","icon"])}}},at={key:0,class:"bg-white hover:shadow-lg text-gray-900 transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},nt={class:"flex justify-end items-start mb-3"},it={class:"flex gap-2"},ot={key:0,class:"mb-4 flex md:flex-row flex-col gap-2"},ct={class:"flex justify-center mb-4"},ut={class:"text-2xl font-bold text-gray-900"},dt={key:0,class:"mb-2"},mt={class:"flex flex-wrap gap-2"},ft={key:1,class:"mb-4"},gt={class:"grid grid-cols-1 sm:grid-cols-2 gap-1"},pt={class:"flex items-center space-x-1"},ht={class:"flex items-center space-x-1"},bt=["title"],xt={key:2,class:"mb-4"},yt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},vt={class:"flex items-center space-x-1"},_t=["title"],wt={class:"flex items-center space-x-1"},Ft={class:"text-gray-800 font-mono font-medium"},$t={key:3,class:"mb-4"},St={class:"gap-3"},Ct={class:"flex items-center justify-between"},kt={class:"flex items-center space-x-2"},jt=["title"],It={class:"text-gray-800 font-mono font-medium text-lg"},Lt={key:4,class:"mb-4"},Nt={class:"gap-3"},Dt={class:"flex items-center space-x-2"},Ot=["title"],qt={class:"flex items-center space-x-2"},Bt=["href","title"],At={class:"space-y-3 flex-1"},Mt={key:0,class:"text-sm font-medium text-gray-700 mb-2"},Rt={key:0,class:"mr-2 text-base"},Tt=["title"],Pt={class:"text-xs text-gray-500 mt-auto pt-2 border-t border-gray-100 flex flex-row justify-end"},Ut={key:0},Vt={__name:"CardView",props:{item:{type:Object,required:!0},schema:{type:Object,default:null},loading:{type:Boolean,default:!1},editRoute:{type:String,default:"/edit"},itemIdField:{type:String,default:"id"}},emits:["deleteItem"],setup(e,{emit:t}){const a=E(),u=ie(),o=e,g=t,m=y(()=>{if(!o.schema?.properties||!o.item)return{titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};const c=o.schema.properties,i=o.item,r={titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};return Object.entries(c).forEach(([d,x])=>{const k=i[d];if(!(!k&&x.type!=="checkbox"&&x.type!=="select"&&x.type!=="multi_select"))switch(x.type){case"title":r.titleFields.push([d,k]);break;case"checkbox":r.booleanFields.push([d,k||!1]);break;case"number":x.number?.format&&x.number.format!=="number"?r.currencyNumberFields.push([d,k||0]):r.regularNumberFields.push([d,k||0]);break;case"url":r.urlFields.push([d,k]);break;case"select":case"multi_select":r.otherFields.push([d,x]);break;default:d.toLowerCase().includes("email")||d.toLowerCase().includes("phone")||d.toLowerCase().includes("contact")||x.type==="email"||x.type==="phone"?r.contactFields.push([d,k]):x.type!=="title"&&x.type!=="number"&&x.type!=="checkbox"&&x.type!=="url"&&r.otherFields.push([d,x])}}),r}),f=y(()=>m.value.titleFields),w=y(()=>m.value.contactFields),L=y(()=>m.value.booleanFields),N=y(()=>m.value.currencyNumberFields),D=y(()=>m.value.regularNumberFields),M=y(()=>m.value.urlFields),P=y(()=>m.value.otherFields),U=c=>{if(c==="contact")return qe;if(c==="numbers")return Ue;const i=o.schema?.properties?.[c];if(!i)return Q;switch(i.type){case"rich_text":return je;case"url":return Ee;case"date":return Qe;case"select":case"multi_select":return Je;case"checkbox":return G;default:return Q}},V=c=>c!=="contact"&&c!=="numbers",h=()=>{const c=o.item[o.itemIdField];a.push(`${o.editRoute}/${c}`)},v=()=>{const c=o.item[o.itemIdField],i=f.value.length>0?f.value[0][1]:"this item";u.require({message:`Are you sure you want to delete "${i}"?`,header:"Confirm Deletion",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{g("deleteItem",c)},reject:()=>{}})},_=c=>se.formatLabel(c),F=c=>c?new Date(c).toLocaleDateString():"",O=c=>o.schema?.properties?.[c]||null,K=(c,i)=>{const r=c.toLowerCase();return r.includes("email")||i?.type==="email"?"pi pi-envelope text-blue-500":r.includes("phone")||r.includes("mobile")||i?.type==="phone"?"pi pi-phone text-green-500":r.includes("linkedin")||r.includes("social")?"pi pi-linkedin text-blue-600":r.includes("website")||r.includes("url")?"pi pi-globe text-purple-500":r.includes("address")||r.includes("location")?"pi pi-map-marker text-red-500":"pi pi-user text-gray-500"},X=c=>{const i=O(c);if(!i||i.type!=="number"||!i.number?.format)return null;const r=le(i.number.format);return r||{dollar:"$",euro:"€",pound:"£",yen:"¥",rupee:"₹",yuan:"¥",percent:"%"}[i.number.format]||i.number.format.toUpperCase()},z=(c,i=null)=>{if(typeof c!="number")return c;const r=i?O(i):null;return r?re(c,r):c.toLocaleString()},Y=()=>{if(f.value.length>0){const i=f.value[0][1];if(i&&typeof i=="string"){const r=i.trim().split(/\s+/);if(r.length>=2)return`${r[0][0]}${r[r.length-1][0]}`.toUpperCase();if(r.length===1)return r[0][0].toUpperCase()}}const c=Object.values(o.item).find(i=>i&&typeof i=="string"&&i.trim().length>0);return c?c.trim()[0].toUpperCase():"?"},Z=()=>{if(o.schema?.properties){const c=Object.entries(o.schema.properties).find(([i,r])=>r.type==="url"&&(i.toLowerCase().includes("image")||i.toLowerCase().includes("photo")||i.toLowerCase().includes("avatar")||i.toLowerCase().includes("picture")));if(c){const i=o.item[c[0]];if(i&&typeof i=="object"&&i.url)return i.url;if(typeof i=="string"&&i.trim())return i.trim()}}return null};return(c,i)=>e.item&&Object.keys(e.item).length>0?(s(),n("div",at,[l("div",nt,[l("div",it,[C(W,{icon:"pi pi-pencil",severity:"success",onClick:h}),C(W,{icon:"pi pi-trash",severity:"danger",onClick:v})])]),f.value.length>0?(s(),n("div",ot,[l("div",ct,[C(B(oe),{label:Y(),image:Z(),size:"xlarge",shape:"circle",class:"border-2 border-gray-200 shadow-md bg-gray-100 p-2"},null,8,["label","image"])]),(s(!0),n($,null,S(f.value,([r,d])=>(s(),n("div",{key:r,class:"flex flex-col justify-start gap-2 mb-2 ml-4"},[l("h2",ut,p(d),1),L.value.length>0?(s(),n("div",dt,[l("div",mt,[(s(!0),n($,null,S(L.value,([x,k])=>(s(),j(G,{key:x,value:k,"field-name":x,"format-label":_},null,8,["value","field-name"]))),128))])])):b("",!0)]))),128))])):b("",!0),w.value.length>0?(s(),n("div",ft,[l("div",gt,[(s(!0),n($,null,S(w.value,([r,d])=>(s(),n("div",{key:r,class:"flex items-center justify-start bg-blue-50 rounded-lg p-1 gap-1"},[l("div",pt,[l("i",{class:I(K(r,O(r)))},null,2)]),l("div",ht,[l("span",{class:"text-gray-800 font-medium text-sm truncate max-w-32",title:d||"Not provided"},p(d||"Not provided"),9,bt)])]))),128))])])):b("",!0),N.value.length>0?(s(),n("div",xt,[l("div",yt,[(s(!0),n($,null,S(N.value,([r,d])=>(s(),n("div",{key:r,class:"flex flex-col items-center justify-between bg-green-50 rounded-lg p-1 border border-green-200"},[l("div",vt,[l("span",{class:"text-sm font-medium text-gray-700 truncate max-w-24",title:_(r)},p(_(r)),9,_t)]),l("div",wt,[l("span",Ft,p(z(d||0,r)),1)])]))),128))])])):b("",!0),D.value.length>0?(s(),n("div",$t,[l("div",St,[(s(!0),n($,null,S(D.value,([r,d])=>(s(),n("div",{key:r,class:"flex-col items-center justify-between bg-gray-50 rounded-lg p-3"},[l("div",Ct,[l("div",kt,[l("i",{class:I([B(J)(r,O(r)),"text-blue-500"])},null,2),l("span",{class:"text-sm font-medium text-gray-700",title:_(r)},p(_(r)),9,jt)]),l("span",It,p(z(d||0,r)),1)])]))),128))])])):b("",!0),M.value.length>0?(s(),n("div",Lt,[l("div",Nt,[(s(!0),n($,null,S(M.value,([r,d])=>(s(),n("div",{key:r,class:"flex-col items-center justify-between bg-purple-50 rounded-lg p-3 border border-purple-200"},[l("div",Dt,[i[0]||(i[0]=l("i",{class:"pi pi-link text-purple-600"},null,-1)),l("span",{class:"text-sm font-medium text-gray-700",title:_(r)},p(_(r)),9,Ot)]),l("div",qt,[l("a",{href:d,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline",title:d},p(d||"No URL"),9,Bt)])]))),128))])])):b("",!0),l("div",At,[(s(!0),n($,null,S(P.value,([r,d])=>(s(),n("div",{key:r,class:"space-y-1 pt-2 border-b border-gray-100 last:border-b-0"},[V(r)?(s(),n("div",Mt,[d?.emoji?(s(),n("span",Rt,p(d.emoji),1)):d?.icon?(s(),n("i",{key:1,class:I([d.icon,"mr-2 text-gray-500"])},null,2)):b("",!0),l("span",{class:"truncate max-w-32",title:_(r)},p(_(r)),9,Tt)])):b("",!0),(s(),j(ue(U(r)),{value:e.item[r],"field-name":r,schema:e.schema,"format-label":_,"format-number":z,"get-schema-property":O,"get-field-currency-symbol":X},null,8,["value","field-name","schema"]))]))),128))]),l("div",Pt,[l("span",null,"Added: "+p(F(e.item.created_time)),1),e.item.last_edited_time!==e.item.created_time?(s(),n("span",Ut," • Updated: "+p(F(e.item.last_edited_time)),1)):b("",!0)])])):b("",!0)}},zt={class:"bg-white hover:shadow-lg transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},Et={class:"text-center py-16 flex-1 flex flex-col items-center justify-center"},Ht={__name:"EmptyState",emits:["add-item"],setup(e){return(t,a)=>{const u=A;return s(),n("div",zt,[l("div",Et,[a[2]||(a[2]=l("div",{class:"text-6xl mb-4"},"📋",-1)),a[3]||(a[3]=l("h3",{class:"text-2xl font-semibold text-gray-900 mb-2"},"No items yet",-1)),a[4]||(a[4]=l("p",{class:"text-gray-600 mb-6 text-center max-w-md"},"Start building your collection by adding your first item to get started.",-1)),C(u,{onClick:a[0]||(a[0]=o=>t.$emit("add-item")),severity:"primary"},{default:q(()=>a[1]||(a[1]=[l("i",{class:"pi pi-plus mr-2"},null,-1),T("Add First Item ",-1)])),_:1,__:[1]})])])}}},Gt={class:"space-y-6"},Qt={key:1,class:"space-y-6"},Wt={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Jt={__name:"ListView",props:{loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},items:{type:Array,default:()=>[]},schema:{type:Object,default:null},hasMore:{type:Boolean,default:!1}},emits:["deleteItem","loadMore"],setup(e,{emit:t}){const a=E(),u=t,o=()=>{a.push("/add")},g=m=>{u("deleteItem",m)};return(m,f)=>(s(),n("div",Gt,[e.loading?(s(),j(H,{key:0,count:6,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"})):(s(),n("div",Qt,[e.schema?(s(),n("div",Wt,[(s(!0),n($,null,S(e.items,w=>(s(),j(Vt,{key:w.id,item:w,schema:e.schema,onDeleteItem:g},null,8,["item","schema"]))),128)),!e.loading&&e.items.length===0?(s(),j(Ht,{key:0,onAddItem:o})):b("",!0),e.loadingMore?(s(),j(H,{key:1,count:3,class:"contents"})):b("",!0)])):b("",!0)])),e.hasMore&&!e.loading?(s(),j(Ce,{key:2,loading:e.loadingMore,onLoadMore:m.loadMore},null,8,["loading","onLoadMore"])):b("",!0)]))}},Kt={class:"home-view"},Xt={class:"space-y-8"},Yt={__name:"HomeView",setup(e){const t=ne(),a=y(()=>t.loading),u=y(()=>t.error),o=y(()=>t.items),g=y(()=>{if(!t.schema?.properties)return null;const v=t.getDatabaseInfo()?.schema?.properties||{};return{...t.schema,properties:Object.fromEntries(Object.entries(t.schema.properties).map(([_,F])=>[_,{...F,type:F.type,required:F.required||!1,emoji:F.emoji||null,icon:F.icon||null,number:F.number||null,select:F.select||null,multi_select:F.multi_select||null,...v[_]&&{number:{...F.number,format:v[_].number?.format||F.number?.format}}}]))}}),m=R(!1),f=R(""),w=R(""),L=R(!1),N=async()=>{try{const[h,v]=await Promise.allSettled([t.ensureSchemaLoaded(),t.fetchAllItems()]);h.status==="rejected"&&console.error("Schema loading failed:",h.reason),v.status==="rejected"&&console.error("Items loading failed:",v.reason),h.status==="fulfilled"&&v.status==="fulfilled"&&D()}catch(h){console.error("Failed to initialize:",h)}},D=()=>{const h=t.getDatabaseInfo();h&&(h.title&&(f.value=h.title),h.description&&(w.value=h.description))},M=async()=>{try{const[h,v]=await Promise.allSettled([t.fetchSchema(!0),t.fetchAllItems()]);h.status==="fulfilled"&&v.status==="fulfilled"?D():(console.error("Schema refresh failed:",h.status==="rejected"?h.reason:"Unknown error"),console.error("Items refresh failed:",v.status==="rejected"?v.reason:"Unknown error"))}catch(h){console.error("Failed to refresh schema:",h)}},P=async()=>{if(!(!L.value||m.value))try{m.value=!0}catch(h){console.error("Failed to load more:",h)}finally{m.value=!1}},U=async()=>{await N()},V=async h=>{try{await t.deleteItem(h),await t.fetchAllItems()}catch(v){console.error("Failed to delete item:",v)}};return de(()=>{N()}),(h,v)=>(s(),n("div",Kt,[l("div",Xt,[C(xe,{loading:a.value,"database-title":f.value,"database-description":w.value,onRefreshSchema:M},null,8,["loading","database-title","database-description"]),C(we,{error:u.value,onRetry:U},null,8,["error"]),C(Jt,{loading:a.value,"loading-more":m.value,items:o.value,schema:g.value,"has-more":L.value,onDeleteItem:V,onLoadMore:P},null,8,["loading","loading-more","items","schema","has-more"])])]))}},rs=ae(Yt,[["__scopeId","data-v-5925e735"]]);export{rs as default};
