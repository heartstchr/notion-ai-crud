import{r as m,o as ce,c as u,d,e as t,z as i,q as p,h as g,L as r,F as P,E as I,t as $,s as T,S as de,I as xe,J as he,v as Y,p as we,l as _e,U as ke,n as ue}from"./vendor-vue-3gpeyM8i.js";import{c as pe,a as v,h as Q,f as W,l as ie,m as me,n as re,e as Te,d as ye}from"./vendor-primevue-jzoCNuJp.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"template-editor"},Se={class:"flex items-center justify-between mb-6"},$e={class:"flex gap-2"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8"},Ee={class:"flex items-start justify-between mb-3"},Ve={class:"flex-1"},je={class:"font-semibold text-gray-900"},De={class:"text-sm text-gray-600 mt-1"},Ne={class:"flex items-center gap-4 mt-2 text-xs text-gray-500"},Pe={key:0,class:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full"},Ie={key:1,class:"px-2 py-1 bg-gray-100 text-gray-600 rounded-full"},Je={class:"flex gap-2"},Fe={key:0,class:"space-y-6"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Me={class:"flex items-center justify-between mb-4"},ze={class:"space-y-4"},Le={class:"flex items-center justify-between mb-3"},Ae={class:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-3"},Be={key:0,class:"mt-3"},Re={class:"space-y-2"},qe={key:1,class:"mt-3"},Ge={class:"flex items-center justify-between mb-4"},He={key:0,class:"bg-gray-50 p-4 rounded-lg"},Ke={class:"flex justify-end gap-2"},Ye={class:"space-y-4"},Qe={class:"flex items-center gap-2"},We={key:0,class:"bg-gray-50 p-4 rounded-lg"},Xe={class:"text-sm text-gray-600"},Ze={class:"list-disc list-inside mt-2"},et={class:"flex justify-end gap-2"},tt={__name:"TemplateEditor",emits:["template-deployed"],setup(fe,{emit:x}){const C=x,y=pe(),j=m([]),O=m(!1),E=m(!1),c=m(null),S=m(null),N=m(!1),J=m(!1),w=m(!1),_=m(""),V=m(null),M=m(!1),A=m([{label:"Title",value:"title"},{label:"Text",value:"rich_text"},{label:"Number",value:"number"},{label:"Select",value:"select"},{label:"Multi-select",value:"multi_select"},{label:"Date",value:"date"},{label:"People",value:"people"},{label:"Files",value:"files"},{label:"Checkbox",value:"checkbox"},{label:"URL",value:"url"},{label:"Email",value:"email"},{label:"Phone",value:"phone_number"},{label:"Created Time",value:"created_time"},{label:"Last Edited Time",value:"last_edited_time"}]),X=m([{label:"Gray",value:"gray"},{label:"Blue",value:"blue"},{label:"Green",value:"green"},{label:"Yellow",value:"yellow"},{label:"Orange",value:"orange"},{label:"Red",value:"red"},{label:"Purple",value:"purple"},{label:"Pink",value:"pink"}]),z=m([{label:"Number",value:"number"},{label:"Dollar",value:"dollar"},{label:"Percent",value:"percent"}]),F=async()=>{try{const e=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"list_templates"})})).json();j.value=e.templates||[]}catch(s){console.error("Error loading templates:",s),y.add({severity:"error",summary:"Error",detail:"Failed to load templates",life:5e3})}},Z=()=>{c.value={id:"",title:"",description:"",properties:{Name:{type:"title",title:{}}}},S.value=null,w.value=!1,_.value="",O.value=!0},B=async s=>{try{const a=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"get_template",payload:{templateId:s.id}})})).json();c.value={...a.template},S.value=s.id,a.template.sampleData&&(w.value=!0,_.value=JSON.stringify(a.template.sampleData,null,2)),O.value=!0}catch(e){console.error("Error loading template:",e),y.add({severity:"error",summary:"Error",detail:"Failed to load template details",life:5e3})}},ee=async()=>{if(!c.value.id||!c.value.title){y.add({severity:"warn",summary:"Validation Error",detail:"Template ID and title are required",life:5e3});return}N.value=!0;try{const s={...c.value};if(w.value&&_.value)try{s.sampleData=JSON.parse(_.value)}catch{y.add({severity:"warn",summary:"Invalid JSON",detail:"Sample data must be valid JSON",life:5e3});return}const e=S.value?"update_template":"save_template",a=S.value?{templateId:S.value,updates:s}:{templateId:c.value.id,template:s},D=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,payload:a})})).json();if(D.success)y.add({severity:"success",summary:"Success",detail:D.message,life:5e3}),O.value=!1,await F();else throw new Error(D.error||"Failed to save template")}catch(s){console.error("Error saving template:",s),y.add({severity:"error",summary:"Error",detail:s.message,life:5e3})}finally{N.value=!1}},te=()=>{O.value=!1,c.value=null,S.value=null},R=async s=>{const e=`${s.id}_copy_${Date.now()}`;try{const b=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"duplicate_template",payload:{templateId:s.id,newTemplateId:e,customizations:{title:`${s.title} (Copy)`}}})})).json();if(b.success)y.add({severity:"success",summary:"Success",detail:"Template duplicated successfully",life:5e3}),await F();else throw new Error(b.error||"Failed to duplicate template")}catch(a){console.error("Error duplicating template:",a),y.add({severity:"error",summary:"Error",detail:a.message,life:5e3})}},q=async s=>{try{const a=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deploy_template",payload:{templateId:s.id,includeSampleData:!0}})})).json();if(a.database)y.add({severity:"success",summary:"Success",detail:`Database "${a.database.title}" created successfully!`,life:5e3}),C("template-deployed",a.database);else throw new Error("Failed to create database")}catch(e){console.error("Error deploying template:",e),y.add({severity:"error",summary:"Error",detail:"Failed to deploy template",life:5e3})}},ae=()=>{const s=`Property ${Object.keys(c.value.properties).length+1}`;c.value.properties[s]={type:"rich_text",rich_text:{}}},L=s=>{delete c.value.properties[s]},le=(s,e)=>{if(s===e)return;const a=c.value.properties[s];delete c.value.properties[s],c.value.properties[e]=a},se=(s,e)=>{const a={type:e};switch(e){case"title":a.title={};break;case"rich_text":a.rich_text={};break;case"number":a.number={format:"number"};break;case"select":a.select={options:[]};break;case"multi_select":a.multi_select={options:[]};break;case"date":a.date={};break;case"people":a.people={};break;case"files":a.files={};break;case"checkbox":a.checkbox={};break;case"url":a.url={};break;case"email":a.email={};break;case"phone_number":a.phone_number={};break;case"created_time":a.created_time={};break;case"last_edited_time":a.last_edited_time={};break}c.value.properties[s]=a},G=(s,e)=>{c.value.properties[s].number.format=e},H=s=>s.type==="select"?s.select?.options||[]:s.type==="multi_select"?s.multi_select?.options||[]:[],oe=s=>{const e=c.value.properties[s],b={name:`Option ${H(e).length+1}`,color:"gray"};e.type==="select"?(e.select.options||(e.select.options=[]),e.select.options.push(b)):e.type==="multi_select"&&(e.multi_select.options||(e.multi_select.options=[]),e.multi_select.options.push(b))},n=(s,e)=>{const a=c.value.properties[s];a.type==="select"?a.select.options.splice(e,1):a.type==="multi_select"&&a.multi_select.options.splice(e,1)},l=s=>{const e=[{label:"Edit",command:()=>B(s)},{label:"Duplicate",command:()=>R(s)},{label:"Deploy",command:()=>q(s)}];return s.custom&&e.push({label:"Delete",command:()=>f(s)}),e},o=s=>{s.command()},f=async s=>{if(confirm(`Are you sure you want to delete "${s.title}"?`))try{const a=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete_template",payload:{templateId:s.id}})})).json();if(a.success)y.add({severity:"success",summary:"Success",detail:"Template deleted successfully",life:5e3}),await F();else throw new Error(a.error||"Failed to delete template")}catch(e){console.error("Error deleting template:",e),y.add({severity:"error",summary:"Error",detail:e.message,life:5e3})}},h=async()=>{try{const e=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"export_templates"})})).json(),a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),b=URL.createObjectURL(a),D=document.createElement("a");D.href=b,D.download="notion-templates.json",D.click(),URL.revokeObjectURL(b),y.add({severity:"success",summary:"Success",detail:"Templates exported successfully",life:5e3})}catch(s){console.error("Error exporting templates:",s),y.add({severity:"error",summary:"Error",detail:"Failed to export templates",life:5e3})}},U=()=>{E.value=!0,V.value=null},be=s=>{const e=s.target.files[0];if(!e)return;const a=new FileReader;a.onload=b=>{try{V.value=JSON.parse(b.target.result)}catch{y.add({severity:"error",summary:"Invalid File",detail:"Selected file is not valid JSON",life:5e3})}},a.readAsText(e)},ge=async()=>{if(V.value){J.value=!0;try{const e=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"import_templates",payload:{templates:V.value.templates,overwrite:M.value}})})).json();if(e.success)y.add({severity:"success",summary:"Success",detail:e.message,life:5e3}),E.value=!1,await F();else throw new Error(e.error||"Failed to import templates")}catch(s){console.error("Error importing templates:",s),y.add({severity:"error",summary:"Error",detail:s.message,life:5e3})}finally{J.value=!1}}};return ce(()=>{F()}),(s,e)=>(d(),u("div",Ce,[t("div",Se,[e[12]||(e[12]=t("div",null,[t("h2",{class:"text-2xl font-semibold text-gray-900"},"Template Editor"),t("p",{class:"text-gray-600 mt-1"},"Create and customize database templates")],-1)),t("div",$e,[i(r(v),{onClick:U,severity:"secondary",outlined:""},{default:p(()=>e[9]||(e[9]=[t("i",{class:"pi pi-upload mr-2"},null,-1),g(" Import ",-1)])),_:1,__:[9]}),i(r(v),{onClick:h,severity:"secondary",outlined:""},{default:p(()=>e[10]||(e[10]=[t("i",{class:"pi pi-download mr-2"},null,-1),g(" Export ",-1)])),_:1,__:[10]}),i(r(v),{onClick:Z,class:"bg-gradient-to-r from-blue-500 to-purple-500 text-white"},{default:p(()=>e[11]||(e[11]=[t("i",{class:"pi pi-plus mr-2"},null,-1),g(" New Template ",-1)])),_:1,__:[11]})])]),t("div",Oe,[(d(!0),u(P,null,I(j.value,a=>(d(),u("div",{key:a.id,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},[t("div",Ee,[t("div",Ve,[t("h3",je,$(a.title),1),t("p",De,$(a.description),1),t("div",Ne,[t("span",null,$(a.propertyCount)+" properties",1),a.custom?(d(),u("span",Pe,"Custom")):(d(),u("span",Ie,"System"))])]),i(r(Q),{options:l(a),onCommand:o},{trigger:p(()=>[i(r(v),{severity:"secondary",text:"",class:"p-2"},{default:p(()=>e[13]||(e[13]=[t("i",{class:"pi pi-ellipsis-v"},null,-1)])),_:1,__:[13]})]),_:2},1032,["options"])]),t("div",Je,[i(r(v),{onClick:b=>B(a),size:"small",severity:"secondary",outlined:"",class:"flex-1"},{default:p(()=>e[14]||(e[14]=[t("i",{class:"pi pi-pencil mr-1"},null,-1),g(" Edit ",-1)])),_:2,__:[14]},1032,["onClick"]),i(r(v),{onClick:b=>R(a),size:"small",severity:"secondary",outlined:""},{default:p(()=>e[15]||(e[15]=[t("i",{class:"pi pi-copy"},null,-1)])),_:2,__:[15]},1032,["onClick"]),i(r(v),{onClick:b=>q(a),size:"small",class:"bg-gradient-to-r from-blue-500 to-purple-500 text-white"},{default:p(()=>e[16]||(e[16]=[t("i",{class:"pi pi-bolt"},null,-1)])),_:2,__:[16]},1032,["onClick"])])]))),128))]),i(r(re),{visible:O.value,"onUpdate:visible":e[5]||(e[5]=a=>O.value=a),header:c.value?.id?"Edit Template":"New Template",modal:"",class:"w-full max-w-4xl",dismissableMask:!1},{footer:p(()=>[t("div",Ke,[i(r(v),{onClick:te,severity:"secondary",outlined:""},{default:p(()=>e[32]||(e[32]=[g(" Cancel ",-1)])),_:1,__:[32]}),i(r(v),{onClick:ee,loading:N.value},{default:p(()=>e[33]||(e[33]=[t("i",{class:"pi pi-save mr-2"},null,-1),g(" Save Template ",-1)])),_:1,__:[33]},8,["loading"])])]),default:p(()=>[c.value?(d(),u("div",Fe,[t("div",Ue,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Template ID",-1)),i(r(W),{modelValue:c.value.id,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value.id=a),placeholder:"e.g., my_custom_template",disabled:!!S.value,class:"w-full"},null,8,["modelValue","disabled"])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Title",-1)),i(r(W),{modelValue:c.value.title,"onUpdate:modelValue":e[1]||(e[1]=a=>c.value.title=a),placeholder:"Template Title",class:"w-full"},null,8,["modelValue"])])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),i(r(ie),{modelValue:c.value.description,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.description=a),placeholder:"Describe what this template is for...",rows:"3",class:"w-full"},null,8,["modelValue"])]),t("div",null,[t("div",Me,[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Properties",-1)),i(r(v),{onClick:ae,size:"small"},{default:p(()=>e[20]||(e[20]=[t("i",{class:"pi pi-plus mr-2"},null,-1),g(" Add Property ",-1)])),_:1,__:[20]})]),t("div",ze,[(d(!0),u(P,null,I(c.value.properties,(a,b,D)=>(d(),u("div",{key:b,class:"bg-gray-50 p-4 rounded-lg border"},[t("div",Le,[t("div",Ae,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Property Name",-1)),i(r(W),{modelValue:b,"onUpdate:modelValue":k=>le(b,k),placeholder:"Property Name",class:"w-full text-sm"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Type",-1)),i(r(Q),{modelValue:a.type,"onUpdate:modelValue":k=>se(b,k),options:A.value,optionLabel:"label",optionValue:"value",placeholder:"Select Type",class:"w-full text-sm"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Actions",-1)),i(r(v),{onClick:k=>L(b),severity:"danger",text:"",size:"small",class:"p-2"},{default:p(()=>e[24]||(e[24]=[t("i",{class:"pi pi-trash"},null,-1)])),_:2,__:[24]},1032,["onClick"])])])]),a.type==="select"||a.type==="multi_select"?(d(),u("div",Be,[e[28]||(e[28]=t("label",{class:"block text-xs font-medium text-gray-600 mb-2"},"Options",-1)),t("div",Re,[(d(!0),u(P,null,I(H(a),(k,ne)=>(d(),u("div",{key:ne,class:"flex items-center gap-2"},[i(r(W),{modelValue:k.name,"onUpdate:modelValue":K=>k.name=K,placeholder:"Option name",class:"flex-1 text-sm"},null,8,["modelValue","onUpdate:modelValue"]),i(r(Q),{modelValue:k.color,"onUpdate:modelValue":K=>k.color=K,options:X.value,optionLabel:"label",optionValue:"value",class:"w-24 text-sm"},null,8,["modelValue","onUpdate:modelValue","options"]),i(r(v),{onClick:K=>n(b,ne),severity:"danger",text:"",size:"small",class:"p-1"},{default:p(()=>e[26]||(e[26]=[t("i",{class:"pi pi-times text-xs"},null,-1)])),_:2,__:[26]},1032,["onClick"])]))),128)),i(r(v),{onClick:k=>oe(b),severity:"secondary",text:"",size:"small",class:"text-xs"},{default:p(()=>e[27]||(e[27]=[t("i",{class:"pi pi-plus mr-1"},null,-1),g(" Add Option ",-1)])),_:2,__:[27]},1032,["onClick"])])])):T("",!0),a.type==="number"?(d(),u("div",qe,[e[29]||(e[29]=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Format",-1)),i(r(Q),{modelValue:a.number?.format||"number","onUpdate:modelValue":k=>G(b,k),options:z.value,optionLabel:"label",optionValue:"value",class:"w-full text-sm"},null,8,["modelValue","onUpdate:modelValue","options"])])):T("",!0)]))),128))])]),t("div",null,[t("div",Ge,[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Sample Data (Optional)",-1)),i(r(me),{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=a=>w.value=a),onLabel:"Enabled",offLabel:"Disabled",class:"text-sm"},null,8,["modelValue"])]),w.value?(d(),u("div",He,[e[31]||(e[31]=t("p",{class:"text-sm text-gray-600 mb-3"},"Add sample data that will be created when the template is deployed ",-1)),i(r(ie),{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value=a),placeholder:'[{"Property Name": {"title": [{"text": {"content": "Sample Value"}}]}}]',rows:"6",class:"w-full font-mono text-xs"},null,8,["modelValue"])])):T("",!0)])])):T("",!0)]),_:1},8,["visible","header"]),i(r(re),{visible:E.value,"onUpdate:visible":e[8]||(e[8]=a=>E.value=a),header:"Import Templates",modal:"",class:"w-full max-w-2xl"},{footer:p(()=>[t("div",et,[i(r(v),{onClick:e[7]||(e[7]=a=>E.value=!1),severity:"secondary",outlined:""},{default:p(()=>e[37]||(e[37]=[g(" Cancel ",-1)])),_:1,__:[37]}),i(r(v),{onClick:ge,disabled:!V.value,loading:J.value},{default:p(()=>e[38]||(e[38]=[g(" Import Templates ",-1)])),_:1,__:[38]},8,["disabled","loading"])])]),default:p(()=>[t("div",Ye,[t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select JSON File",-1)),t("input",{type:"file",accept:".json",onChange:be,class:"w-full p-2 border border-gray-300 rounded-lg"},null,32)]),t("div",Qe,[i(r(Te),{modelValue:M.value,"onUpdate:modelValue":e[6]||(e[6]=a=>M.value=a),inputId:"overwrite"},null,8,["modelValue"]),e[35]||(e[35]=t("label",{for:"overwrite",class:"text-sm text-gray-700"},"Overwrite existing templates",-1))]),V.value?(d(),u("div",We,[e[36]||(e[36]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Preview",-1)),t("div",Xe,[t("p",null,$(Object.keys(V.value.templates||{}).length)+" templates found",1),t("ul",Ze,[(d(!0),u(P,null,I(Object.keys(V.value.templates||{}),a=>(d(),u("li",{key:a},$(a),1))),128))])])])):T("",!0)])]),_:1},8,["visible"]),i(r(ye))]))}},at=ve(tt,[["__scopeId","data-v-cd057a8c"]]),lt={class:"chat-view min-h-screen bg-gray-50"},st={class:"max-w-4xl mx-auto px-4 py-6 flex flex-col h-[calc(100vh-88px)]"},ot={key:0,class:"flex-1 flex items-center justify-center"},it={class:"text-center max-w-2xl"},rt={class:"flex items-center justify-center gap-3 mb-6 p-3 bg-blue-50 rounded-lg border border-blue-200"},nt={key:0,class:"mb-8"},dt={class:"flex items-center justify-between mb-4"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ct=["onClick","disabled"],pt={class:"flex items-center justify-between"},mt={class:"font-medium text-gray-900 group-hover:text-blue-600"},yt={class:"text-xs text-gray-500 mt-1"},vt={key:0,class:"inline-block px-2 py-1 mt-1 text-xs bg-blue-100 text-blue-700 rounded-full"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"},bt=["onClick"],gt={class:"flex items-start gap-3"},xt={class:"font-medium text-gray-900"},ht={class:"text-sm text-gray-600 mt-1"},wt={class:"flex flex-wrap justify-center gap-3"},_t=["onClick"],kt={key:1,class:"flex-1 overflow-y-auto space-y-6 py-4"},Tt={key:0,class:"flex-shrink-0"},Ct={key:0,class:"mb-3"},St=["innerHTML"],$t={key:1,class:"mt-4 p-3 bg-gray-50 rounded-lg border"},Ot={class:"flex items-center justify-between mb-2"},Et={key:0,class:"mb-3"},Vt={class:"flex gap-2 mt-2"},jt={key:1,class:"text-xs text-gray-600 overflow-x-auto"},Dt={class:"flex gap-2 mt-3"},Nt={key:1,class:"flex-shrink-0"},Pt={key:0,class:"flex gap-4"},It={class:"border-t border-gray-200 pt-4 mt-4"},Jt={class:"relative"},Ft={class:"relative z-10 bg-white rounded-xl p-4"},Ut={class:"flex items-end gap-3"},Mt={class:"flex-1"},zt={class:"flex gap-2"},Lt={__name:"ChatView",setup(fe){const x=pe(),C=m([]),y=m(""),j=m(!1),O=m(!1),E=m(!1),c=m([]),S=m(!1),N=m(!1),J=m({}),w=m(""),_=m(null),V=m([{icon:"pi pi-database",title:"Create Project Database",description:"Generate a database schema for project management",text:"Create a project management database with tasks, deadlines, and team members"},{icon:"pi pi-users",title:"Customer Database",description:"Build a CRM database for customer information",text:"Create a customer relationship management database with contacts and interactions"},{icon:"pi pi-book",title:"Content Library",description:"Organize articles, resources, and documentation",text:"Create a content library database for articles, resources, and documentation"},{icon:"pi pi-chart-line",title:"Analytics Dashboard",description:"Track metrics and performance data",text:"Create an analytics database to track metrics and performance data"}]),M=m([{icon:"pi pi-calendar",label:"Event Calendar",prompt:"Create an event calendar database"},{icon:"pi pi-shopping-cart",label:"Inventory",prompt:"Create an inventory management database"},{icon:"pi pi-graduation-cap",label:"Course Tracker",prompt:"Create a course and learning tracker database"},{icon:"pi pi-heart",label:"Habit Tracker",prompt:"Create a habit tracking database"}]),A=n=>{y.value=n,z()},X=n=>{n.key==="Enter"&&!n.shiftKey&&z()},z=async()=>{if(!y.value.trim()||j.value)return;const n={id:Date.now()+Math.random(),role:"user",content:y.value.trim(),timestamp:new Date};C.value.push(n);const l=y.value.trim();y.value="",j.value=!0;try{if(E.value){const U=await se(l);if(U&&U.confidence>.8){await G(U.suggestedTemplate,{title:U.customizations?.title||l,...U.customizations});return}}const o=await fetch("/.netlify/functions/gemini-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l,context:"notion_database_schema"})});if(!o.ok)throw new Error("Failed to get AI response");const f=await o.json(),h={id:Date.now()+Math.random(),role:"assistant",content:f.content,schema:f.schema||null,timestamp:new Date};C.value.push(h)}catch(o){console.error("Error sending message:",o),x.add({severity:"error",summary:"Error",detail:"Failed to get AI response. Please try again.",life:5e3}),C.value.push({id:Date.now()+Math.random(),role:"assistant",content:'I apologize, but I encountered an error processing your request. <button onclick="window.location.reload()" class="text-blue-500 underline hover:text-blue-700 cursor-pointer">Please try again</button>.',timestamp:new Date})}finally{j.value=!1,await ue(),L()}},F=async n=>{const l=prompt("Enter Database ID (optional - leave empty to use default):");O.value=!0;try{const o=await fetch("/.netlify/functions/create-notion-database",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({schema:n,databaseId:l||null})});if(!o.ok)throw new Error("Failed to create database");const f=await o.json();x.add({severity:"success",summary:"Success",detail:`Database "${f.title}" created successfully in Notion!`,life:5e3}),C.value.push({id:Date.now()+Math.random(),role:"assistant",content:`✅ Great! I've successfully created the "${f.title}" database in your Notion workspace. You can access it at: ${f.url}`,timestamp:new Date})}catch(o){console.error("Error creating database:",o);let f="Failed to create database in Notion. Please check your integration settings.";try{const h=await o.json();h.details&&(f=`${h.error}: ${h.details}`)}catch{}x.add({severity:"error",summary:"Error",detail:f,life:8e3})}finally{O.value=!1}},Z=async n=>{try{await navigator.clipboard.writeText(JSON.stringify(n,null,2)),x.add({severity:"success",summary:"Copied",detail:"Schema copied to clipboard",life:3e3})}catch(l){console.error("Error copying schema:",l),x.add({severity:"error",summary:"Error",detail:"Failed to copy schema",life:3e3})}},B=(n,l)=>{_.value=l,w.value=JSON.stringify(n,null,2),J.value=n},ee=n=>{try{const l=JSON.parse(w.value),o=C.value.findIndex(f=>f.id===n);o!==-1&&(C.value[o].schema=l),_.value=null,w.value="",J.value={},x.add({severity:"success",summary:"Schema Updated",detail:"Schema has been successfully updated",life:3e3})}catch(l){console.error("Error parsing schema:",l),x.add({severity:"error",summary:"Invalid JSON",detail:"Please check your JSON syntax and try again",life:5e3})}},te=()=>{_.value=null,w.value="",J.value={},x.add({severity:"info",summary:"Edit Cancelled",detail:"Schema editing has been cancelled",life:2e3})},R=n=>n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-gray-100 px-1 py-0.5 rounded text-sm">$1</code>').replace(/\n/g,"<br>"),q=()=>{x.add({severity:"info",summary:"Coming Soon",detail:"File attachment feature will be available soon!",life:3e3})},ae=()=>{x.add({severity:"info",summary:"Coming Soon",detail:"Voice input feature will be available soon!",life:3e3})},L=()=>{const n=document.querySelector(".overflow-y-auto");n&&(n.scrollTop=n.scrollHeight)},le=async()=>{try{const l=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"list_templates"})})).json();c.value=l.templates||[]}catch(n){console.error("Error loading templates:",n)}},se=async n=>{try{return await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"smart_suggest",payload:{userInput:n}})})).json()}catch(l){return console.error("Error getting smart suggestion:",l),null}},G=async(n,l={})=>{S.value=!0;try{const f=await(await fetch("/.netlify/functions/automation-engine",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deploy_template",payload:{templateId:n,customizations:l,includeSampleData:!0}})})).json();f.database&&(x.add({severity:"success",summary:"Success",detail:`Database "${f.database.title}" created automatically!`,life:5e3}),C.value.push({id:Date.now()+Math.random(),role:"assistant",content:`🚀 **Automation Success!** I've automatically created the "${f.database.title}" database for you based on your request. You can access it at: ${f.database.url}`,timestamp:new Date}))}catch(o){console.error("Error deploying template:",o),x.add({severity:"error",summary:"Automation Error",detail:"Failed to auto-deploy template",life:5e3})}finally{S.value=!1,j.value=!1,await ue(),L()}},H=async n=>{await G(n.id)},oe=n=>{C.value.push({id:Date.now()+Math.random(),role:"assistant",content:`✅ Template deployed successfully! Database "${n.title}" is now available in your Notion workspace.`,timestamp:new Date}),N.value=!1,L()};return ce(async()=>{const n=document.querySelector("textarea");n&&n.focus(),await le()}),(n,l)=>(d(),u("div",lt,[t("div",st,[C.value.length===0?(d(),u("div",ot,[t("div",it,[l[10]||(l[10]=t("div",{class:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-6"},[t("i",{class:"pi pi-sparkles text-white text-2xl"})],-1)),l[11]||(l[11]=t("h2",{class:"text-2xl font-semibold text-gray-900 mb-4"},"Hi, there 👋",-1)),l[12]||(l[12]=t("p",{class:"text-gray-600 mb-8"},"Tell us what you need, and we'll handle the rest.",-1)),t("div",rt,[l[5]||(l[5]=t("i",{class:"pi pi-bolt text-blue-500"},null,-1)),l[6]||(l[6]=t("span",{class:"text-blue-700 font-medium"},"Automation Mode",-1)),i(r(me),{modelValue:E.value,"onUpdate:modelValue":l[0]||(l[0]=o=>E.value=o),onLabel:"ON",offLabel:"OFF",class:"p-0"},null,8,["modelValue"])]),E.value&&c.value.length>0?(d(),u("div",nt,[t("div",dt,[l[8]||(l[8]=t("h3",{class:"text-lg font-semibold text-gray-900"},"🚀 Quick Deploy Templates",-1)),i(r(v),{onClick:l[1]||(l[1]=o=>N.value=!0),severity:"secondary",outlined:"",size:"small"},{default:p(()=>l[7]||(l[7]=[t("i",{class:"pi pi-cog mr-2"},null,-1),g(" Manage Templates ",-1)])),_:1,__:[7]})]),t("div",ut,[(d(!0),u(P,null,I(c.value,o=>(d(),u("button",{key:o.id,onClick:f=>H(o),disabled:S.value,class:"p-3 bg-white border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition-all text-left group disabled:opacity-50"},[t("div",pt,[t("div",null,[t("p",mt,$(o.title),1),t("p",yt,$(o.propertyCount)+" properties",1),o.custom?(d(),u("div",vt," Custom ")):T("",!0)]),l[9]||(l[9]=t("i",{class:"pi pi-bolt text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity"},null,-1))])],8,ct))),128))])])):T("",!0),t("div",ft,[(d(!0),u(P,null,I(V.value,o=>(d(),u("button",{key:o.text,onClick:f=>A(o.text),class:"p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition-all text-left"},[t("div",gt,[t("i",{class:Y([o.icon,"text-blue-500 text-lg mt-1"])},null,2),t("div",null,[t("p",xt,$(o.title),1),t("p",ht,$(o.description),1)])])],8,bt))),128))]),t("div",wt,[(d(!0),u(P,null,I(M.value,o=>(d(),u("button",{key:o.label,onClick:f=>A(o.prompt),class:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-full text-sm text-gray-700 transition-colors"},[t("i",{class:Y([o.icon,"text-sm"])},null,2),g(" "+$(o.label),1)],8,_t))),128))])])])):(d(),u("div",kt,[(d(!0),u(P,null,I(C.value,(o,f)=>(d(),u("div",{key:f,class:Y(["flex gap-4",o.role==="user"?"justify-end":"justify-start"])},[o.role==="assistant"?(d(),u("div",Tt,l[13]||(l[13]=[t("div",{class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center"},[t("i",{class:"pi pi-sparkles text-white text-sm"})],-1)]))):T("",!0),t("div",{class:Y(["max-w-3xl",o.role==="user"?"bg-blue-500 text-white rounded-2xl rounded-br-sm px-4 py-3":"bg-white border border-gray-200 rounded-2xl rounded-bl-sm px-4 py-3"])},[o.role==="assistant"&&o.thinking?(d(),u("div",Ct,l[14]||(l[14]=[de('<div class="flex items-center gap-2 text-gray-500 text-sm mb-2" data-v-b31dd0e3><div class="flex space-x-1" data-v-b31dd0e3><div class="w-1 h-1 bg-gray-400 rounded-full animate-pulse" data-v-b31dd0e3></div><div class="w-1 h-1 bg-gray-400 rounded-full animate-pulse" style="animation-delay:0.2s;" data-v-b31dd0e3></div><div class="w-1 h-1 bg-gray-400 rounded-full animate-pulse" style="animation-delay:0.4s;" data-v-b31dd0e3></div></div><span data-v-b31dd0e3>Thinking...</span></div>',1)]))):T("",!0),t("div",{innerHTML:R(o.content)},null,8,St),o.schema?(d(),u("div",$t,[t("div",Ot,[l[17]||(l[17]=t("h4",{class:"font-medium text-gray-900"},"Generated Schema Preview",-1)),t("div",null,[!_.value||_.value!==o.id?(d(),we(r(v),{key:0,onClick:h=>B(o.schema,o.id),severity:"secondary",size:"small",text:"",class:"p-1"},{default:p(()=>l[15]||(l[15]=[t("i",{class:"pi pi-pencil text-xs"},null,-1)])),_:2,__:[15]},1032,["onClick"])):T("",!0),i(r(v),{onClick:h=>Z(o.schema),severity:"secondary",size:"small",text:""},{default:p(()=>l[16]||(l[16]=[t("i",{class:"pi pi-copy"},null,-1)])),_:2,__:[16]},1032,["onClick"])])]),_.value===o.id?(d(),u("div",Et,[_e(t("textarea",{"onUpdate:modelValue":l[2]||(l[2]=h=>w.value=h),class:"w-full h-64 p-3 text-xs font-mono bg-white border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Edit your schema JSON here..."},null,512),[[ke,w.value]]),t("div",Vt,[i(r(v),{onClick:h=>ee(o.id),size:"small",class:"flex-1"},{default:p(()=>l[18]||(l[18]=[t("i",{class:"pi pi-check mr-2"},null,-1),g(" Save Changes ",-1)])),_:2,__:[18]},1032,["onClick"]),i(r(v),{onClick:te,severity:"secondary",size:"small",text:""},{default:p(()=>l[19]||(l[19]=[t("i",{class:"pi pi-times mr-2"},null,-1),g(" Cancel ",-1)])),_:1,__:[19]})])])):(d(),u("pre",jt,$(JSON.stringify(o.schema,null,2)),1)),t("div",Dt,[i(r(v),{onClick:h=>F(o.schema),loading:O.value,size:"small",class:"flex-1"},{default:p(()=>l[20]||(l[20]=[t("i",{class:"pi pi-plus mr-2"},null,-1),g(" Create in Notion ",-1)])),_:2,__:[20]},1032,["onClick","loading"])])])):T("",!0)],2),o.role==="user"?(d(),u("div",Nt,l[21]||(l[21]=[t("div",{class:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center"},[t("i",{class:"pi pi-user text-gray-600 text-sm"})],-1)]))):T("",!0)],2))),128)),j.value?(d(),u("div",Pt,l[22]||(l[22]=[de('<div class="flex-shrink-0" data-v-b31dd0e3><div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center" data-v-b31dd0e3><i class="pi pi-sparkles text-white text-sm" data-v-b31dd0e3></i></div></div><div class="bg-white border border-gray-200 rounded-2xl rounded-bl-sm px-4 py-3" data-v-b31dd0e3><div class="flex items-center gap-2 text-gray-500" data-v-b31dd0e3><div class="flex space-x-1" data-v-b31dd0e3><div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" data-v-b31dd0e3></div><div class="w-2 h-2 bg-purple-500 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-b31dd0e3></div><div class="w-2 h-2 bg-pink-500 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-b31dd0e3></div></div><span class="text-sm" data-v-b31dd0e3>AI is thinking...</span></div></div>',2)]))):T("",!0)])),t("div",It,[t("div",Jt,[l[26]||(l[26]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-xl p-0.5"},[t("div",{class:"bg-white rounded-xl h-full w-full"})],-1)),t("div",Ft,[t("div",Ut,[t("div",Mt,[i(r(ie),{modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=o=>y.value=o),placeholder:"Ask me anything...",rows:1,autoResize:!0,class:"w-full border-0 focus:ring-0 resize-none",onKeydown:xe(he(X,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),t("div",zt,[i(r(v),{onClick:q,severity:"secondary",text:"",class:"p-2"},{default:p(()=>l[23]||(l[23]=[t("i",{class:"pi pi-paperclip"},null,-1)])),_:1,__:[23]}),i(r(v),{onClick:ae,severity:"secondary",text:"",class:"p-2"},{default:p(()=>l[24]||(l[24]=[t("i",{class:"pi pi-microphone"},null,-1)])),_:1,__:[24]}),i(r(v),{onClick:z,disabled:!y.value.trim()||j.value,class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all disabled:opacity-50"},{default:p(()=>l[25]||(l[25]=[t("i",{class:"pi pi-send"},null,-1)])),_:1,__:[25]},8,["disabled"])])])])])])]),i(r(re),{visible:N.value,"onUpdate:visible":l[4]||(l[4]=o=>N.value=o),header:"Template Manager",modal:"",class:"w-full max-w-6xl",dismissableMask:!1},{default:p(()=>[i(at,{onTemplateDeployed:oe})]),_:1},8,["visible"]),i(r(ye))]))}},qt=ve(Lt,[["__scopeId","data-v-b31dd0e3"]]);export{qt as default};
