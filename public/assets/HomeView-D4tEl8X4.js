import{g as J,a as ee,b as te,N as se,f as re,c as le,_ as H,u as ae}from"./LoadingSkeleton-DFnSR5vn.js";import{a as A,u as ne,b as ie}from"./vendor-primevue-Bo0b_ULt.js";import{Q as E,c as a,d as t,s as b,e as s,t as f,z as S,q,h as T,y as x,F,E as $,G as oe,v as I,L as B,p as k,x as ce,r as R,o as de}from"./vendor-vue-Bq-k71LZ.js";import{_ as ue}from"./index-W9ofhJZT.js";const me={class:"text-center space-y-4"},fe={key:0,class:"space-y-2"},pe={key:1,class:"text-4xl font-bold text-gray-900"},ge={key:2,class:"space-y-2"},he={key:3,class:"text-lg text-gray-600 max-w-2xl mx-auto"},be={class:"flex justify-end gap-4 flex-wrap"},xe={__name:"HeaderView",props:{loading:{type:Boolean,default:!1},databaseTitle:{type:String,default:""},databaseDescription:{type:String,default:""}},emits:["refreshSchema"],setup(e,{emit:l}){const n=E(),d=l,o=()=>{d("refreshSchema")},h=()=>{n.push("/add")};return(p,m)=>{const j=A;return t(),a("div",me,[e.loading&&!e.databaseTitle?(t(),a("div",fe,m[0]||(m[0]=[s("div",{class:"h-12 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"300px"}},null,-1)]))):(t(),a("h1",pe,f(e.databaseTitle),1)),e.loading&&!e.databaseDescription?(t(),a("div",ge,m[1]||(m[1]=[s("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"500px"}},null,-1),s("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"400px"}},null,-1)]))):e.databaseDescription?(t(),a("p",he,f(e.databaseDescription),1)):b("",!0),s("div",be,[S(j,{onClick:o,disabled:e.loading,severity:"secondary"},{default:q(()=>m[2]||(m[2]=[s("i",{class:"pi pi-refresh"},null,-1),T("Refresh ",-1)])),_:1,__:[2]},8,["disabled"]),S(j,{onClick:h,severity:"primary"},{default:q(()=>m[3]||(m[3]=[s("i",{class:"pi pi-plus"},null,-1),T("Add ",-1)])),_:1,__:[3]})])])}}},_e={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3"},ye={class:"flex-1"},ve={class:"text-red-700"},we={__name:"ErrorDisplay",props:{error:{type:String,default:""}},emits:["retry"],setup(e){return(l,n)=>{const d=A;return e.error?(t(),a("div",_e,[n[2]||(n[2]=s("i",{class:"pi pi-exclamation-triangle text-red-500 text-xl"},null,-1)),s("div",ye,[n[1]||(n[1]=s("strong",{class:"text-red-800"},"Error:",-1)),s("span",ve,f(e.error),1),S(d,{onClick:l.retry,severity:"danger",text:""},{default:q(()=>n[0]||(n[0]=[T(" Try Again ",-1)])),_:1,__:[0]},8,["onClick"])])])):b("",!0)}}},Fe={class:"text-center"},$e={key:0},Se={key:1},Ce={__name:"LoadMoreButton",props:{loading:{type:Boolean,default:!1}},emits:["load-more"],setup(e){return(l,n)=>{const d=A;return t(),a("div",Fe,[S(d,{onClick:n[0]||(n[0]=o=>l.$emit("load-more")),disabled:e.loading,severity:"secondary"},{default:q(()=>[e.loading?(t(),a("span",$e,"Loading...")):(t(),a("span",Se,"Load More"))]),_:1},8,["disabled"])])}}},je={class:"text-gray-800 leading-relaxed"},ke={__name:"RichTextField",props:{value:{type:Object,required:!0}},setup(e){const l=e,n=x(()=>Array.isArray(l.value)?l.value:l.value&&typeof l.value=="object"?l.value.rich_text||l.value.title||[]:typeof l.value=="string"?[{text:{content:l.value},annotations:{}}]:[]),d=o=>{if(!o)return{};const h={};return o.italic&&(h.fontStyle="italic"),o.underline&&(h.textDecoration="underline"),o.strikethrough&&(h.textDecoration="line-through"),o.code&&(h.fontFamily="monospace",h.backgroundColor="#f3f4f6",h.padding="2px 4px",h.borderRadius="4px"),h};return(o,h)=>(t(),a("div",je,[(t(!0),a(F,null,$(n.value,(p,m)=>(t(),a("span",{key:m,class:I(p.annotations?.bold?"font-semibold":""),style:oe(d(p.annotations))},f(p.text?.content||p.plain_text||""),7))),128))]))}},Ie={class:"grid grid-cols-2 gap-4"},Le={key:0,class:"flex items-center space-x-2"},Ne={class:"text-gray-800"},De={key:1,class:"flex items-center space-x-2"},Oe={class:"text-gray-800"},qe={__name:"ContactField",props:{value:{type:Object,required:!0}},setup(e){return(l,n)=>(t(),a("div",Ie,[e.value?.email?(t(),a("div",Le,[n[0]||(n[0]=s("i",{class:"pi pi-envelope text-blue-500"},null,-1)),s("span",Ne,f(e.value.email),1)])):b("",!0),e.value?.phone?(t(),a("div",De,[n[1]||(n[1]=s("i",{class:"pi pi-phone text-green-500"},null,-1)),s("span",Oe,f(e.value.phone),1)])):b("",!0)]))}},Be={class:"space-y-3"},Ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Me={class:"text-sm font-medium text-gray-700"},Re={class:"flex items-center space-x-2"},Te={class:"text-gray-800 font-mono font-medium"},Pe={key:0,class:"text-lg text-gray-600 font-medium"},Ue={__name:"NumbersField",props:{value:{type:Object,required:!0},schema:{type:Object,default:null},formatLabel:{type:Function,required:!0},formatNumber:{type:Function,required:!0},getSchemaProperty:{type:Function,required:!0},getFieldCurrencySymbol:{type:Function,required:!0}},setup(e){return(l,n)=>(t(),a("div",Be,[s("div",Ae,[(t(!0),a(F,null,$(e.value,(d,o)=>(t(),a("div",{key:o,class:"flex items-center justify-start bg-gray-50 rounded-lg gap-2 p-2"},[s("i",{class:I([B(J)(o,e.getSchemaProperty(o)),"text-blue-500"])},null,2),s("span",Me,f(e.formatLabel(o)),1),s("div",Re,[s("span",Te,f(e.formatNumber(d||0,o)),1),e.getFieldCurrencySymbol(o)?(t(),a("span",Pe,f(e.getFieldCurrencySymbol(o)),1)):b("",!0)])]))),128))])]))}},Ve={class:"flex items-center space-x-2"},ze=["href"],Ee={__name:"UrlField",props:{value:{type:Object,required:!0}},setup(e){const l=n=>{try{const d=new URL(n);return d.hostname+d.pathname}catch{return n}};return(n,d)=>(t(),a("div",Ve,[d[0]||(d[0]=s("i",{class:"pi pi-link text-purple-500"},null,-1)),s("a",{href:e.value.url,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline truncate max-w-xs"},f(l(e.value.url)),9,ze)]))}},He={class:"flex items-center space-x-2"},Ge={class:"text-gray-800"},Qe={__name:"DateField",props:{value:{type:Object,required:!0}},setup(e){const l=n=>n?new Date(n).toLocaleDateString():"";return(n,d)=>(t(),a("div",He,[d[0]||(d[0]=s("i",{class:"pi pi-calendar text-indigo-500"},null,-1)),s("span",Ge,f(l(e.value.date?.start||e.value.date)),1)]))}},We={class:"flex flex-wrap gap-2"},Je={__name:"SelectField",props:{value:{type:[Object,Array],required:!0},fieldName:{type:String,required:!0},schema:{type:Object,default:null}},setup(e){const l=e,n=x(()=>({name:l.fieldName,options:o(l.fieldName,l.schema)})),d=x(()=>ee(l.value)),o=(h,p)=>!p||!p.properties||!p.properties[h]?[]:p.properties[h].options||[];return(h,p)=>(t(),a("div",We,[(t(!0),a(F,null,$(d.value,m=>(t(),a("span",{key:m.value||m,class:I([B(te)(m,n.value,e.schema),"px-3 py-1.5 text-sm rounded-full border font-medium"])},f(m.label||m),3))),128))]))}},Ke={class:"flex items-center gap-2"},Xe={key:0,class:"flex items-center gap-1 bg-green-500 text-white px-2 py-1 rounded-full text-sm"},Ye={class:"font-medium"},Ze={key:1,class:"flex items-center gap-1 bg-gray-200 text-gray-600 px-2 py-1 rounded-full text-sm"},et={class:"font-medium"},G={__name:"BooleanField",props:{value:{type:Boolean,required:!0},fieldName:{type:String,required:!0},formatLabel:{type:Function,required:!0}},setup(e){return(l,n)=>(t(),a("div",Ke,[e.value?(t(),a("div",Xe,[n[0]||(n[0]=s("i",{class:"pi pi-check-circle"},null,-1)),s("span",Ye,f(e.formatLabel(e.fieldName)),1)])):(t(),a("div",Ze,[n[1]||(n[1]=s("i",{class:"pi pi-times-circle"},null,-1)),s("span",et,f(e.formatLabel(e.fieldName)),1)]))]))}},tt={class:"text-gray-800 leading-relaxed"},Q={__name:"TextField",props:{value:{type:[String,Number],required:!0}},setup(e){return(l,n)=>(t(),a("div",tt,f(e.value),1))}};function st(e="primary",l="small",n=!1){return{buttonPT:x(()=>({root:{class:[rt(l),lt(e),"rounded-lg flex items-center justify-center","transition-all duration-300 hover:scale-105 hover:-translate-y-0.5","shadow-lg hover:shadow-xl","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed"]},icon:{class:n?"m-0":"mr-2"}}))}}function rt(e){const l={small:"px-3 py-1.5 text-sm",large:"px-6 py-3 text-lg",default:"px-4 py-2"};return l[e]||l.default}function lt(e){const l={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 hover:shadow-[0_20px_40px_rgba(37,99,235,0.3),0_0_20px_rgba(37,99,235,0.2)]",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 hover:text-gray-800 border border-gray-300 focus:ring-gray-500 hover:shadow-[0_20px_40px_rgba(107,114,128,0.3),0_0_20px_rgba(107,114,128,0.2)]",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500 hover:shadow-[0_20px_40px_rgba(239,68,68,0.3),0_0_20px_rgba(239,68,68,0.2)]",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 hover:shadow-[0_20px_40px_rgba(34,197,94,0.3),0_0_20px_rgba(34,197,94,0.2)]",warning:"bg-amber-600 hover:bg-amber-700 text-white focus:ring-amber-500 hover:shadow-[0_20px_40px_rgba(217,119,6,0.3),0_0_20px_rgba(217,119,6,0.2)]",info:"bg-cyan-600 hover:bg-cyan-700 text-white focus:ring-cyan-500 hover:shadow-[0_20px_40px_rgba(6,182,212,0.3),0_0_20px_rgba(6,182,212,0.2)]"};return l[e]||l.primary}const W={__name:"IconButton",props:{icon:{type:String,required:!0},severity:{type:String,default:"primary"},size:{type:String,default:"small"}},emits:["click"],setup(e){const l=e,{buttonPT:n}=st(l.severity,l.size,!0);return(d,o)=>{const h=A;return t(),k(h,{pt:B(n),icon:e.icon,onClick:o[0]||(o[0]=p=>d.$emit("click"))},null,8,["pt","icon"])}}},at={key:0,class:"bg-white hover:shadow-lg text-gray-900 transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},nt={class:"flex justify-end items-start mb-3"},it={class:"flex gap-2"},ot={key:0,class:"mb-4 flex md:flex-row flex-col gap-2"},ct={class:"flex justify-center mb-4"},dt={class:"text-2xl font-bold text-gray-900"},ut={key:0,class:"mb-4 ml-4"},mt={class:"flex flex-wrap gap-2"},ft={key:1,class:"mb-4"},pt={class:"grid grid-cols-1 sm:grid-cols-2 gap-1"},gt={class:"flex items-center space-x-1"},ht={class:"flex items-center space-x-1"},bt=["title"],xt={key:2,class:"mb-4"},_t={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},yt={class:"flex items-center space-x-1"},vt=["title"],wt={class:"flex items-center space-x-1"},Ft={class:"text-gray-800 font-mono font-medium"},$t={key:3,class:"mb-4"},St={class:"gap-3"},Ct={class:"flex items-center justify-between"},jt={class:"flex items-center space-x-2"},kt=["title"],It={class:"text-gray-800 font-mono font-medium text-lg"},Lt={key:4,class:"mb-4"},Nt={class:"gap-3"},Dt={class:"flex items-center space-x-2"},Ot=["title"],qt={class:"flex items-center space-x-2"},Bt=["href","title"],At={class:"space-y-3 flex-1"},Mt={key:0,class:"text-sm font-medium text-gray-700 mb-2"},Rt={key:0,class:"mr-2 text-base"},Tt=["title"],Pt={class:"text-xs text-gray-500 mt-auto pt-2 border-t border-gray-100 flex flex-row justify-end"},Ut={key:0},Vt={__name:"CardView",props:{item:{type:Object,required:!0},schema:{type:Object,default:null},loading:{type:Boolean,default:!1},editRoute:{type:String,default:"/edit"},itemIdField:{type:String,default:"id"}},emits:["deleteItem"],setup(e,{emit:l}){const n=E(),d=ne(),o=e,h=l,p=x(()=>{if(!o.schema?.properties||!o.item)return{titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};const c=o.schema.properties,i=o.item,r={titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};return Object.entries(c).forEach(([u,v])=>{const C=i[u];if(!(!C&&v.type!=="checkbox"))switch(v.type){case"title":r.titleFields.push([u,C]);break;case"checkbox":r.booleanFields.push([u,C||!1]);break;case"number":v.number?.format&&v.number.format!=="number"?r.currencyNumberFields.push([u,C||0]):r.regularNumberFields.push([u,C||0]);break;case"url":r.urlFields.push([u,C]);break;default:u.toLowerCase().includes("email")||u.toLowerCase().includes("phone")||u.toLowerCase().includes("contact")||v.type==="email"||v.type==="phone"?r.contactFields.push([u,C]):v.type!=="title"&&v.type!=="number"&&v.type!=="checkbox"&&v.type!=="url"&&r.otherFields.push([u,v])}}),r}),m=x(()=>p.value.titleFields),j=x(()=>p.value.contactFields),L=x(()=>p.value.booleanFields),N=x(()=>p.value.currencyNumberFields),D=x(()=>p.value.regularNumberFields),M=x(()=>p.value.urlFields),P=x(()=>p.value.otherFields),U=c=>{if(c==="contact")return qe;if(c==="numbers")return Ue;const i=o.schema?.properties?.[c];if(!i)return Q;switch(i.type){case"rich_text":return ke;case"url":return Ee;case"date":return Qe;case"select":case"multi_select":return Je;case"checkbox":return G;default:return Q}},V=c=>c!=="contact"&&c!=="numbers",g=()=>{const c=o.item[o.itemIdField];n.push(`${o.editRoute}/${c}`)},_=()=>{const c=o.item[o.itemIdField],i=m.value.length>0?m.value[0][1]:"this item";d.require({message:`Are you sure you want to delete "${i}"?`,header:"Confirm Deletion",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{h("deleteItem",c)},reject:()=>{}})},y=c=>se.formatLabel(c),w=c=>c?new Date(c).toLocaleDateString():"",O=c=>o.schema?.properties?.[c]||null,K=(c,i)=>{const r=c.toLowerCase();return r.includes("email")||i?.type==="email"?"pi pi-envelope text-blue-500":r.includes("phone")||r.includes("mobile")||i?.type==="phone"?"pi pi-phone text-green-500":r.includes("linkedin")||r.includes("social")?"pi pi-linkedin text-blue-600":r.includes("website")||r.includes("url")?"pi pi-globe text-purple-500":r.includes("address")||r.includes("location")?"pi pi-map-marker text-red-500":"pi pi-user text-gray-500"},X=c=>{const i=O(c);if(!i||i.type!=="number"||!i.number?.format)return null;const r=le(i.number.format);return r||{dollar:"$",euro:"â‚¬",pound:"Â£",yen:"Â¥",rupee:"â‚¹",yuan:"Â¥",percent:"%"}[i.number.format]||i.number.format.toUpperCase()},z=(c,i=null)=>{if(typeof c!="number")return c;const r=i?O(i):null;return r?re(c,r):c.toLocaleString()},Y=()=>{if(m.value.length>0){const i=m.value[0][1];if(i&&typeof i=="string"){const r=i.trim().split(/\s+/);if(r.length>=2)return`${r[0][0]}${r[r.length-1][0]}`.toUpperCase();if(r.length===1)return r[0][0].toUpperCase()}}const c=Object.values(o.item).find(i=>i&&typeof i=="string"&&i.trim().length>0);return c?c.trim()[0].toUpperCase():"?"},Z=()=>{if(o.schema?.properties){const c=Object.entries(o.schema.properties).find(([i,r])=>r.type==="url"&&(i.toLowerCase().includes("image")||i.toLowerCase().includes("photo")||i.toLowerCase().includes("avatar")||i.toLowerCase().includes("picture")));if(c){const i=o.item[c[0]];if(i&&typeof i=="object"&&i.url)return i.url;if(typeof i=="string"&&i.trim())return i.trim()}}return null};return(c,i)=>e.item&&Object.keys(e.item).length>0?(t(),a("div",at,[s("div",nt,[s("div",it,[S(W,{icon:"pi pi-pencil",severity:"primary",onClick:g}),S(W,{icon:"pi pi-trash",severity:"danger",onClick:_})])]),m.value.length>0?(t(),a("div",ot,[s("div",ct,[S(B(ie),{label:Y(),image:Z(),size:"xlarge",shape:"circle",class:"border-2 border-gray-200 shadow-md bg-gray-100 p-2"},null,8,["label","image"])]),(t(!0),a(F,null,$(m.value,([r,u])=>(t(),a("div",{key:r,class:"flex flex-col justify-start gap-3 mb-2 ml-4"},[s("h2",dt,f(u),1),L.value.length>0?(t(),a("div",ut,[s("div",mt,[(t(!0),a(F,null,$(L.value,([v,C])=>(t(),k(G,{key:v,value:C,"field-name":v,"format-label":y},null,8,["value","field-name"]))),128))])])):b("",!0)]))),128))])):b("",!0),j.value.length>0?(t(),a("div",ft,[s("div",pt,[(t(!0),a(F,null,$(j.value,([r,u])=>(t(),a("div",{key:r,class:"flex items-center justify-start bg-blue-50 rounded-lg p-1 gap-1"},[s("div",gt,[s("i",{class:I(K(r,O(r)))},null,2)]),s("div",ht,[s("span",{class:"text-gray-800 font-medium text-sm truncate max-w-32",title:u||"Not provided"},f(u||"Not provided"),9,bt)])]))),128))])])):b("",!0),N.value.length>0?(t(),a("div",xt,[s("div",_t,[(t(!0),a(F,null,$(N.value,([r,u])=>(t(),a("div",{key:r,class:"flex flex-col items-center justify-between bg-green-50 rounded-lg p-1 border border-green-200"},[s("div",yt,[s("span",{class:"text-sm font-medium text-gray-700 truncate max-w-24",title:y(r)},f(y(r)),9,vt)]),s("div",wt,[s("span",Ft,f(z(u||0,r)),1)])]))),128))])])):b("",!0),D.value.length>0?(t(),a("div",$t,[s("div",St,[(t(!0),a(F,null,$(D.value,([r,u])=>(t(),a("div",{key:r,class:"flex-col items-center justify-between bg-gray-50 rounded-lg p-3"},[s("div",Ct,[s("div",jt,[s("i",{class:I([B(J)(r,O(r)),"text-blue-500"])},null,2),s("span",{class:"text-sm font-medium text-gray-700",title:y(r)},f(y(r)),9,kt)]),s("span",It,f(z(u||0,r)),1)])]))),128))])])):b("",!0),M.value.length>0?(t(),a("div",Lt,[s("div",Nt,[(t(!0),a(F,null,$(M.value,([r,u])=>(t(),a("div",{key:r,class:"flex-col items-center justify-between bg-purple-50 rounded-lg p-3 border border-purple-200"},[s("div",Dt,[i[0]||(i[0]=s("i",{class:"pi pi-link text-purple-600"},null,-1)),s("span",{class:"text-sm font-medium text-gray-700",title:y(r)},f(y(r)),9,Ot)]),s("div",qt,[s("a",{href:u,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline",title:u},f(u||"No URL"),9,Bt)])]))),128))])])):b("",!0),s("div",At,[(t(!0),a(F,null,$(P.value,([r,u])=>(t(),a("div",{key:r,class:"space-y-1 pt-2 border-b border-gray-100 last:border-b-0"},[V(r)?(t(),a("div",Mt,[u?.emoji?(t(),a("span",Rt,f(u.emoji),1)):u?.icon?(t(),a("i",{key:1,class:I([u.icon,"mr-2 text-gray-500"])},null,2)):b("",!0),s("span",{class:"truncate max-w-32",title:y(r)},f(y(r)),9,Tt)])):b("",!0),(t(),k(ce(U(r)),{value:e.item[r],"field-name":r,schema:e.schema,"format-label":y,"format-number":z,"get-schema-property":O,"get-field-currency-symbol":X},null,8,["value","field-name","schema"]))]))),128))]),s("div",Pt,[s("span",null,"Added: "+f(w(e.item.created_time)),1),e.item.last_edited_time!==e.item.created_time?(t(),a("span",Ut," â€¢ Updated: "+f(w(e.item.last_edited_time)),1)):b("",!0)])])):b("",!0)}},zt={class:"bg-white hover:shadow-lg transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},Et={class:"text-center py-16 flex-1 flex flex-col items-center justify-center"},Ht={__name:"EmptyState",emits:["add-item"],setup(e){return(l,n)=>{const d=A;return t(),a("div",zt,[s("div",Et,[n[2]||(n[2]=s("div",{class:"text-6xl mb-4"},"ðŸ“‹",-1)),n[3]||(n[3]=s("h3",{class:"text-2xl font-semibold text-gray-900 mb-2"},"No items yet",-1)),n[4]||(n[4]=s("p",{class:"text-gray-600 mb-6 text-center max-w-md"},"Start building your collection by adding your first item to get started.",-1)),S(d,{onClick:n[0]||(n[0]=o=>l.$emit("add-item")),severity:"primary"},{default:q(()=>n[1]||(n[1]=[s("i",{class:"pi pi-plus mr-2"},null,-1),T("Add First Item ",-1)])),_:1,__:[1]})])])}}},Gt={class:"space-y-6"},Qt={key:1,class:"space-y-6"},Wt={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Jt={__name:"ListView",props:{loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},items:{type:Array,default:()=>[]},schema:{type:Object,default:null},hasMore:{type:Boolean,default:!1}},emits:["deleteItem","loadMore"],setup(e){const l=E(),n=()=>{l.push("/add")};return(d,o)=>(t(),a("div",Gt,[e.loading?(t(),k(H,{key:0,count:6,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"})):(t(),a("div",Qt,[e.schema?(t(),a("div",Wt,[(t(!0),a(F,null,$(e.items,h=>(t(),k(Vt,{key:h.id,item:h,schema:e.schema,onDeleteItem:d.deleteItem},null,8,["item","schema","onDeleteItem"]))),128)),!e.loading&&e.items.length===0?(t(),k(Ht,{key:0,onAddItem:n})):b("",!0),e.loadingMore?(t(),k(H,{key:1,count:3,class:"contents"})):b("",!0)])):b("",!0)])),e.hasMore&&!e.loading?(t(),k(Ce,{key:2,loading:e.loadingMore,onLoadMore:d.loadMore},null,8,["loading","onLoadMore"])):b("",!0)]))}},Kt={class:"home-view"},Xt={class:"space-y-8"},Yt={__name:"HomeView",setup(e){const l=ae(),n=x(()=>l.loading),d=x(()=>l.error),o=x(()=>l.items),h=x(()=>{if(!l.schema?.properties)return null;const _=l.getDatabaseInfo()?.schema?.properties||{};return{...l.schema,properties:Object.fromEntries(Object.entries(l.schema.properties).map(([y,w])=>[y,{...w,type:w.type,required:w.required||!1,emoji:w.emoji||null,icon:w.icon||null,number:w.number||null,select:w.select||null,multi_select:w.multi_select||null,..._[y]&&{number:{...w.number,format:_[y].number?.format||w.number?.format}}}]))}}),p=R(!1),m=R(""),j=R(""),L=R(!1),N=async()=>{try{const[g,_]=await Promise.allSettled([l.ensureSchemaLoaded(),l.fetchAllItems()]);g.status==="rejected"&&console.error("Schema loading failed:",g.reason),_.status==="rejected"&&console.error("Items loading failed:",_.reason),g.status==="fulfilled"&&_.status==="fulfilled"&&D()}catch(g){console.error("Failed to initialize:",g)}},D=()=>{const g=l.getDatabaseInfo();g&&(g.title&&(m.value=g.title),g.description&&(j.value=g.description))},M=async()=>{try{const[g,_]=await Promise.allSettled([l.fetchSchema(!0),l.fetchAllItems()]);g.status==="fulfilled"&&_.status==="fulfilled"?D():(console.error("Schema refresh failed:",g.status==="rejected"?g.reason:"Unknown error"),console.error("Items refresh failed:",_.status==="rejected"?_.reason:"Unknown error"))}catch(g){console.error("Failed to refresh schema:",g)}},P=async()=>{if(!(!L.value||p.value))try{p.value=!0}catch(g){console.error("Failed to load more:",g)}finally{p.value=!1}},U=async()=>{await N()},V=async g=>{try{await l.deleteItem(g),await l.fetchAllItems()}catch(_){console.error("Failed to delete item:",_)}};return de(()=>{N()}),(g,_)=>(t(),a("div",Kt,[s("div",Xt,[S(xe,{loading:n.value,"database-title":m.value,"database-description":j.value,onRefreshSchema:M},null,8,["loading","database-title","database-description"]),S(we,{error:d.value,onRetry:U},null,8,["error"]),S(Jt,{loading:n.value,"loading-more":p.value,items:o.value,schema:h.value,"has-more":L.value,onDeleteItem:V,onLoadMore:P},null,8,["loading","loading-more","items","schema","has-more"])])]))}},ls=ue(Yt,[["__scopeId","data-v-5925e735"]]);export{ls as default};
