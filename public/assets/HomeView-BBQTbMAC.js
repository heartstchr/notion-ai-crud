import{g as J,a as ee,b as te,N as se,f as re,_ as H,c as ae,u as le}from"./_plugin-vue_export-helper-BSokui32.js";import{a as B,u as ne,b as ie}from"./vendor-primevue-Bo0b_ULt.js";import{Q as U,c as n,d as r,s as x,e as s,t as p,z as S,q as O,h as R,y as v,F,E as $,G as oe,v as N,L as q,p as k,x as ce,r as M,o as ue}from"./vendor-vue-Bq-k71LZ.js";const de={class:"text-center space-y-4"},me={key:0,class:"space-y-2"},fe={key:1,class:"text-4xl font-bold text-gray-900"},ge={key:2,class:"space-y-2"},pe={key:3,class:"text-lg text-gray-600 max-w-2xl mx-auto"},he={class:"flex justify-end gap-4 flex-wrap"},be={__name:"HeaderView",props:{loading:{type:Boolean,default:!1},databaseTitle:{type:String,default:""},databaseDescription:{type:String,default:""}},emits:["refreshSchema"],setup(e,{emit:t}){const l=U(),u=t,i=()=>{u("refreshSchema")},f=()=>{l.push("/add")};return(g,d)=>{const _=B;return r(),n("div",de,[e.loading&&!e.databaseTitle?(r(),n("div",me,d[0]||(d[0]=[s("div",{class:"h-12 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"300px"}},null,-1)]))):(r(),n("h1",fe,p(e.databaseTitle),1)),e.loading&&!e.databaseDescription?(r(),n("div",ge,d[1]||(d[1]=[s("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"500px"}},null,-1),s("div",{class:"h-6 bg-gray-200 rounded-lg animate-pulse mx-auto",style:{width:"400px"}},null,-1)]))):e.databaseDescription?(r(),n("p",pe,p(e.databaseDescription),1)):x("",!0),s("div",he,[S(_,{onClick:i,disabled:e.loading,severity:"secondary"},{default:O(()=>d[2]||(d[2]=[s("i",{class:"pi pi-refresh"},null,-1),R("Refresh ",-1)])),_:1,__:[2]},8,["disabled"]),S(_,{onClick:f,severity:"primary"},{default:O(()=>d[3]||(d[3]=[s("i",{class:"pi pi-plus"},null,-1),R("Add ",-1)])),_:1,__:[3]})])])}}},xe={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3"},ve={class:"flex-1"},ye={class:"text-red-700"},_e={__name:"ErrorDisplay",props:{error:{type:String,default:""}},emits:["retry"],setup(e){return(t,l)=>{const u=B;return e.error?(r(),n("div",xe,[l[2]||(l[2]=s("i",{class:"pi pi-exclamation-triangle text-red-500 text-xl"},null,-1)),s("div",ve,[l[1]||(l[1]=s("strong",{class:"text-red-800"},"Error:",-1)),s("span",ye,p(e.error),1),S(u,{onClick:t.retry,severity:"danger",text:""},{default:O(()=>l[0]||(l[0]=[R(" Try Again ",-1)])),_:1,__:[0]},8,["onClick"])])])):x("",!0)}}},we={class:"text-center"},Fe={key:0},$e={key:1},Se={__name:"LoadMoreButton",props:{loading:{type:Boolean,default:!1}},emits:["load-more"],setup(e){return(t,l)=>{const u=B;return r(),n("div",we,[S(u,{onClick:l[0]||(l[0]=i=>t.$emit("load-more")),disabled:e.loading,severity:"secondary"},{default:O(()=>[e.loading?(r(),n("span",Fe,"Loading...")):(r(),n("span",$e,"Load More"))]),_:1},8,["disabled"])])}}},je={class:"text-gray-800 leading-relaxed"},Ce={__name:"RichTextField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=e,l=v(()=>Array.isArray(t.value)?t.value:t.value&&typeof t.value=="object"?t.value.rich_text||t.value.title||[]:typeof t.value=="string"?[{text:{content:t.value},annotations:{}}]:[]),u=i=>{if(!i)return{};const f={};return i.italic&&(f.fontStyle="italic"),i.underline&&(f.textDecoration="underline"),i.strikethrough&&(f.textDecoration="line-through"),i.code&&(f.fontFamily="monospace",f.backgroundColor="#f3f4f6",f.padding="2px 4px",f.borderRadius="4px"),f};return(i,f)=>(r(),n("div",je,[(r(!0),n(F,null,$(l.value,(g,d)=>(r(),n("span",{key:d,class:N(g.annotations?.bold?"font-semibold":""),style:oe(u(g.annotations))},p(g.text?.content||g.plain_text||""),7))),128))]))}},ke={class:"grid grid-cols-2 gap-4"},Ie={key:0,class:"flex items-center space-x-2"},Le={class:"text-gray-800"},Ne={key:1,class:"flex items-center space-x-2"},De={class:"text-gray-800"},Oe={__name:"ContactField",props:{value:{type:[Object,String],required:!0}},setup(e){return(t,l)=>(r(),n("div",ke,[typeof e.value=="string"||e.value?.email?(r(),n("div",Ie,[l[0]||(l[0]=s("i",{class:"pi pi-envelope text-blue-500"},null,-1)),s("span",Le,p(typeof e.value=="string"?e.value:e.value.email),1)])):x("",!0),typeof e.value=="string"||e.value?.phone?(r(),n("div",Ne,[l[1]||(l[1]=s("i",{class:"pi pi-phone text-green-500"},null,-1)),s("span",De,p(typeof e.value=="string"?e.value:e.value.phone),1)])):x("",!0)]))}},qe={class:"space-y-3"},Be={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ae={class:"text-sm font-medium text-gray-700"},Me={class:"flex items-center space-x-2"},Re={class:"text-gray-800 font-mono font-medium"},Te={key:0,class:"text-lg text-gray-600 font-medium"},ze={__name:"NumbersField",props:{value:{type:Object,required:!0},schema:{type:Object,default:null},formatLabel:{type:Function,required:!0},formatNumber:{type:Function,required:!0},getSchemaProperty:{type:Function,required:!0},getFieldCurrencySymbol:{type:Function,required:!0}},setup(e){return(t,l)=>(r(),n("div",qe,[s("div",Be,[(r(!0),n(F,null,$(e.value,(u,i)=>(r(),n("div",{key:i,class:"flex items-center justify-start bg-gray-50 rounded-lg gap-2 p-2"},[s("i",{class:N([q(J)(i,e.getSchemaProperty(i)),"text-blue-500"])},null,2),s("span",Ae,p(e.formatLabel(i)),1),s("div",Me,[s("span",Re,p(e.formatNumber(u||0,i)),1),e.getFieldCurrencySymbol(i)?(r(),n("span",Te,p(e.getFieldCurrencySymbol(i)),1)):x("",!0)])]))),128))])]))}},Pe={class:"flex items-center space-x-2"},Ve=["href"],Ue={__name:"UrlField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=l=>{try{const u=new URL(l);return u.hostname+u.pathname}catch{return l}};return(l,u)=>(r(),n("div",Pe,[u[0]||(u[0]=s("i",{class:"pi pi-link text-purple-500"},null,-1)),s("a",{href:typeof e.value=="string"?e.value:e.value.url,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline truncate max-w-xs"},p(t(typeof e.value=="string"?e.value:e.value.url)),9,Ve)]))}},Ee={class:"flex items-center space-x-2"},He={class:"text-gray-800"},Ge={__name:"DateField",props:{value:{type:[Object,String],required:!0}},setup(e){const t=l=>l?new Date(l).toLocaleDateString():"";return(l,u)=>(r(),n("div",Ee,[u[0]||(u[0]=s("i",{class:"pi pi-calendar text-indigo-500"},null,-1)),s("span",He,p(t(typeof e.value=="string"?e.value:e.value.date?.start||e.value.date)),1)]))}},Qe={class:"flex flex-wrap gap-2"},We={__name:"SelectField",props:{value:{type:[Object,Array],required:!0},fieldName:{type:String,required:!0},schema:{type:Object,default:null}},setup(e){const t=e,l=v(()=>({name:t.fieldName,options:i(t.fieldName,t.schema)})),u=v(()=>typeof t.value=="string"&&t.value.trim()?[{value:t.value,label:t.value,name:t.value}]:Array.isArray(t.value)&&t.value.length>0?t.value.map(f=>({value:f,label:f,name:f})):ee(t.value)),i=(f,g)=>!g||!g.properties||!g.properties[f]?[]:g.properties[f].options||[];return(f,g)=>(r(),n("div",Qe,[(r(!0),n(F,null,$(u.value,d=>(r(),n("span",{key:d.value||d,class:N([q(te)(d,l.value,e.schema),"px-3 py-1.5 text-sm rounded-full border font-medium"])},p(d.label||d),3))),128))]))}},Je={class:"flex items-center gap-2"},Ke={key:0,class:"flex items-center gap-1 bg-green-500 text-white px-2 py-1 rounded-full text-sm"},Xe={class:"font-medium"},Ye={key:1,class:"flex items-center gap-1 bg-gray-200 text-gray-600 px-2 py-1 rounded-full text-sm"},Ze={class:"font-medium"},G={__name:"BooleanField",props:{value:{type:Boolean,required:!0},fieldName:{type:String,required:!0},formatLabel:{type:Function,required:!0}},setup(e){return(t,l)=>(r(),n("div",Je,[e.value?(r(),n("div",Ke,[l[0]||(l[0]=s("i",{class:"pi pi-check-circle"},null,-1)),s("span",Xe,p(e.formatLabel(e.fieldName)),1)])):(r(),n("div",Ye,[l[1]||(l[1]=s("i",{class:"pi pi-times-circle"},null,-1)),s("span",Ze,p(e.formatLabel(e.fieldName)),1)]))]))}},et={class:"text-gray-800 leading-relaxed"},Q={__name:"TextField",props:{value:{type:[String,Number],required:!0}},setup(e){return(t,l)=>(r(),n("div",et,p(e.value),1))}};function tt(e="primary",t="small",l=!1){return{buttonPT:v(()=>({root:{class:[st(t),rt(e),"rounded-lg flex items-center justify-center","transition-all duration-300 hover:scale-105 hover:-translate-y-0.5","shadow-lg hover:shadow-xl","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed","!border-0"]},icon:{class:l?"m-0":"mr-2"},label:{class:"font-medium"}}))}}function st(e){const t={small:"px-3 py-1.5 text-sm",large:"px-6 py-3 text-lg",default:"px-4 py-2"};return t[e]||t.default}function rt(e){const t={primary:"!bg-blue-600 !hover:bg-blue-700 !text-white focus:ring-blue-500 hover:shadow-[0_20px_40px_rgba(37,99,235,0.3),0_0_20px_rgba(37,99,235,0.2)]",secondary:"!bg-gray-200 !hover:bg-gray-300 !text-gray-700 hover:text-gray-800 border border-gray-300 focus:ring-gray-500 hover:shadow-[0_20px_40px_rgba(107,114,128,0.3),0_0_20px_rgba(107,114,128,0.2)]",danger:"!bg-red-600 !hover:bg-red-700 !text-white focus:ring-red-500 hover:shadow-[0_20px_40px_rgba(239,68,68,0.3),0_0_20px_rgba(239,68,68,0.2)]",success:"!bg-green-600 !hover:bg-green-700 !text-white focus:ring-green-500 hover:shadow-[0_20px_40px_#22c55e4d,0_0_20px_#22c55e33]",warning:"!bg-amber-600 !hover:bg-amber-700 !text-white focus:ring-amber-500 hover:shadow-[0_20px_40px_rgba(217,119,6,0.3),0_0_20px_rgba(217,119,6,0.2)]",info:"!bg-cyan-600 !hover:bg-cyan-700 !text-white focus:ring-cyan-500 hover:shadow-[0_20px_40px_rgba(6,182,212,0.3),0_0_20px_rgba(6,182,212,0.2)]"};return t[e]||t.primary}const W={__name:"IconButton",props:{icon:{type:String,required:!0},severity:{type:String,default:"primary"},size:{type:String,default:"small"}},emits:["click"],setup(e,{emit:t}){const l=e,{buttonPT:u}=tt(l.severity,l.size,!0),i=t,f=()=>{i("click")};return(g,d)=>{const _=B;return r(),k(_,{pt:q(u),icon:e.icon,onClick:f},null,8,["pt","icon"])}}},at={key:0,class:"bg-white hover:shadow-lg text-gray-900 transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},lt={class:"flex justify-end items-start mb-3"},nt={class:"flex gap-2"},it={key:0,class:"mb-4 flex md:flex-row flex-col gap-2"},ot={class:"flex justify-center mb-4"},ct={class:"text-2xl font-bold text-gray-900"},ut={key:0,class:"mb-2"},dt={class:"flex flex-wrap gap-2"},mt={key:1,class:"mb-4"},ft={class:"grid grid-cols-1 sm:grid-cols-2 gap-1"},gt={class:"flex items-center space-x-1"},pt={class:"flex items-center space-x-1"},ht=["title"],bt={key:2,class:"mb-4"},xt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},vt={class:"flex items-center space-x-1"},yt=["title"],_t={class:"flex items-center space-x-1"},wt={class:"text-gray-800 font-mono font-medium"},Ft={key:3,class:"mb-4"},$t={class:"gap-3"},St={class:"flex items-center justify-between"},jt={class:"flex items-center space-x-2"},Ct=["title"],kt={class:"text-gray-800 font-mono font-medium text-lg"},It={key:4,class:"mb-4"},Lt={class:"gap-3"},Nt={class:"flex items-center space-x-2"},Dt=["title"],Ot={class:"flex items-center space-x-2"},qt=["href","title"],Bt={class:"space-y-3 flex-1"},At={key:0,class:"text-sm font-medium text-gray-700 mb-2"},Mt={key:0,class:"mr-2 text-base"},Rt=["title"],Tt={class:"text-xs text-gray-500 mt-auto pt-2 border-t border-gray-100 flex flex-row justify-end"},zt={key:0},Pt={__name:"CardView",props:{item:{type:Object,required:!0},schema:{type:Object,default:null},loading:{type:Boolean,default:!1},editRoute:{type:String,default:"/edit"},itemIdField:{type:String,default:"id"}},emits:["deleteItem"],setup(e,{emit:t}){const l=U(),u=ne(),i=e,f=t,g=v(()=>{if(!i.schema?.properties||!i.item)return{titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};const o=i.schema.properties,c=i.item,a={titleFields:[],contactFields:[],booleanFields:[],currencyNumberFields:[],regularNumberFields:[],urlFields:[],otherFields:[]};return Object.entries(o).forEach(([m,y])=>{const j=c[m];if(!(!j&&y.type!=="checkbox"&&y.type!=="select"&&y.type!=="multi_select"))switch(y.type){case"title":a.titleFields.push([m,j]);break;case"checkbox":a.booleanFields.push([m,j||!1]);break;case"number":y.number?.format&&y.number.format!=="number"?a.currencyNumberFields.push([m,j||0]):a.regularNumberFields.push([m,j||0]);break;case"url":a.urlFields.push([m,j]);break;case"select":case"multi_select":a.otherFields.push([m,y]);break;default:m.toLowerCase().includes("email")||m.toLowerCase().includes("phone")||m.toLowerCase().includes("contact")||y.type==="email"||y.type==="phone"?a.contactFields.push([m,j]):y.type!=="title"&&y.type!=="number"&&y.type!=="checkbox"&&y.type!=="url"&&a.otherFields.push([m,y])}}),a}),d=v(()=>g.value.titleFields),_=v(()=>g.value.contactFields),I=v(()=>g.value.booleanFields),C=v(()=>g.value.currencyNumberFields),D=v(()=>g.value.regularNumberFields),A=v(()=>g.value.urlFields),T=v(()=>g.value.otherFields),z=v(()=>{if(!i.schema?.properties)return{};const o={};return Object.entries(i.schema.properties).forEach(([c,a])=>{switch(a.type){case"rich_text":o[c]=Ce;break;case"url":o[c]=Ue;break;case"date":o[c]=Ge;break;case"select":case"multi_select":o[c]=We;break;case"checkbox":o[c]=G;break;default:o[c]=Q}}),o}),P=o=>o==="contact"?Oe:o==="numbers"?ze:z.value[o]||Q,h=o=>o!=="contact"&&o!=="numbers",b=o=>se.formatLabel(o),L=(o,c=null)=>{if(typeof o!="number")return o;const a=c?V(c):null;return a?re(o,a):o.toLocaleString()},w=()=>{const o=i.item[i.itemIdField];l.push(`${i.editRoute}/${o}`)},K=()=>{const o=i.item[i.itemIdField],c=d.value.length>0?d.value[0][1]:"this item";u.require({message:`Are you sure you want to delete "${c}"?`,header:"Confirm Deletion",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{f("deleteItem",o)},reject:()=>{}})},E=o=>o?new Date(o).toLocaleDateString():"",V=o=>i.schema?.properties?.[o]||null,X=(o,c)=>{const a=o.toLowerCase();return a.includes("email")||c?.type==="email"?"pi pi-envelope text-blue-500":a.includes("phone")||a.includes("mobile")||c?.type==="phone"?"pi pi-phone text-green-500":a.includes("linkedin")||a.includes("social")?"pi pi-linkedin text-blue-600":a.includes("website")||a.includes("url")?"pi pi-globe text-purple-500":a.includes("address")||a.includes("location")?"pi pi-map-marker text-red-500":"pi pi-user text-gray-500"},Y=()=>{if(d.value.length>0){const c=d.value[0][1];if(c&&typeof c=="string"){const a=c.trim().split(/\s+/);if(a.length>=2)return`${a[0][0]}${a[a.length-1][0]}`.toUpperCase();if(a.length===1)return a[0][0].toUpperCase()}}const o=Object.values(i.item).find(c=>c&&typeof c=="string"&&c.trim().length>0);return o?o.trim()[0].toUpperCase():"?"},Z=()=>{if(i.schema?.properties){const o=Object.entries(i.schema.properties).find(([c,a])=>a.type==="url"&&(c.toLowerCase().includes("image")||c.toLowerCase().includes("photo")||c.toLowerCase().includes("avatar")||c.toLowerCase().includes("picture")));if(o){const c=i.item[o[0]];if(c&&typeof c=="object"&&c.url)return c.url;if(typeof c=="string"&&c.trim())return c.trim()}}return null};return(o,c)=>e.item&&Object.keys(e.item).length>0?(r(),n("div",at,[s("div",lt,[s("div",nt,[S(W,{icon:"pi pi-pencil",severity:"success",onClick:w}),S(W,{icon:"pi pi-trash",severity:"danger",onClick:K})])]),d.value.length>0?(r(),n("div",it,[s("div",ot,[S(q(ie),{label:Y(),image:Z(),size:"xlarge",shape:"circle",class:"border-2 border-gray-200 shadow-md bg-gray-100 p-2"},null,8,["label","image"])]),(r(!0),n(F,null,$(d.value,([a,m])=>(r(),n("div",{key:a,class:"flex flex-col justify-start gap-2 mb-2 ml-4"},[s("h2",ct,p(m),1),I.value.length>0?(r(),n("div",ut,[s("div",dt,[(r(!0),n(F,null,$(I.value,([y,j])=>(r(),k(G,{key:y,value:j,"field-name":y,"format-label":o.formatLabel},null,8,["value","field-name","format-label"]))),128))])])):x("",!0)]))),128))])):x("",!0),_.value.length>0?(r(),n("div",mt,[s("div",ft,[(r(!0),n(F,null,$(_.value,([a,m])=>(r(),n("div",{key:a,class:"flex items-center justify-start bg-blue-50 rounded-lg p-1 gap-1"},[s("div",gt,[s("i",{class:N(X(a,V(a)))},null,2)]),s("div",pt,[s("span",{class:"text-gray-800 font-medium text-sm truncate max-w-32",title:m||"Not provided"},p(m||"Not provided"),9,ht)])]))),128))])])):x("",!0),C.value.length>0?(r(),n("div",bt,[s("div",xt,[(r(!0),n(F,null,$(C.value,([a,m])=>(r(),n("div",{key:a,class:"flex flex-col items-center justify-between bg-green-50 rounded-lg p-1 border border-green-200"},[s("div",vt,[s("span",{class:"text-sm font-medium text-gray-700 truncate max-w-24",title:b(a)},p(b(a)),9,yt)]),s("div",_t,[s("span",wt,p(L(m||0,a)),1)])]))),128))])])):x("",!0),D.value.length>0?(r(),n("div",Ft,[s("div",$t,[(r(!0),n(F,null,$(D.value,([a,m])=>(r(),n("div",{key:a,class:"flex-col items-center justify-between bg-gray-50 rounded-lg p-3"},[s("div",St,[s("div",jt,[s("i",{class:N([q(J)(a,V(a)),"text-blue-500"])},null,2),s("span",{class:"text-sm font-medium text-gray-700",title:b(a)},p(b(a)),9,Ct)]),s("span",kt,p(L(m||0,a)),1)])]))),128))])])):x("",!0),A.value.length>0?(r(),n("div",It,[s("div",Lt,[(r(!0),n(F,null,$(A.value,([a,m])=>(r(),n("div",{key:a,class:"flex-col items-center justify-between bg-purple-50 rounded-lg p-3 border border-purple-200"},[s("div",Nt,[c[0]||(c[0]=s("i",{class:"pi pi-link text-purple-600"},null,-1)),s("span",{class:"text-sm font-medium text-gray-700",title:b(a)},p(b(a)),9,Dt)]),s("div",Ot,[s("a",{href:m,target:"_blank",rel:"noopener noreferrer",class:"text-purple-600 hover:text-purple-800 underline",title:m},p(m||"No URL"),9,qt)])]))),128))])])):x("",!0),s("div",Bt,[(r(!0),n(F,null,$(T.value,([a,m])=>(r(),n("div",{key:a,class:"space-y-1 pt-2 border-b border-gray-100 last:border-b-0"},[h(a)?(r(),n("div",At,[m?.emoji?(r(),n("span",Mt,p(m.emoji),1)):m?.icon?(r(),n("i",{key:1,class:N([m.icon,"mr-2 text-gray-500"])},null,2)):x("",!0),s("span",{class:"truncate max-w-32",title:b(a)},p(b(a)),9,Rt)])):x("",!0),(r(),k(ce(P(a)),{value:e.item[a],"field-name":a,schema:e.schema},null,8,["value","field-name","schema"]))]))),128))]),s("div",Tt,[s("span",null,"Added: "+p(E(e.item.created_time)),1),e.item.last_edited_time!==e.item.created_time?(r(),n("span",zt," â€¢ Updated: "+p(E(e.item.last_edited_time)),1)):x("",!0)])])):x("",!0)}},Vt={class:"bg-white hover:shadow-lg transition-shadow p-4 border-2 border-black rounded-lg shadow-lg flex flex-col h-full"},Ut={class:"text-center py-16 flex-1 flex flex-col items-center justify-center"},Et={__name:"EmptyState",emits:["add-item"],setup(e){return(t,l)=>{const u=B;return r(),n("div",Vt,[s("div",Ut,[l[2]||(l[2]=s("div",{class:"text-6xl mb-4"},"ðŸ“‹",-1)),l[3]||(l[3]=s("h3",{class:"text-2xl font-semibold text-gray-900 mb-2"},"No items yet",-1)),l[4]||(l[4]=s("p",{class:"text-gray-600 mb-6 text-center max-w-md"},"Start building your collection by adding your first item to get started.",-1)),S(u,{onClick:l[0]||(l[0]=i=>t.$emit("add-item")),severity:"primary"},{default:O(()=>l[1]||(l[1]=[s("i",{class:"pi pi-plus mr-2"},null,-1),R("Add First Item ",-1)])),_:1,__:[1]})])])}}},Ht={class:"space-y-6"},Gt={key:1,class:"space-y-6"},Qt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Wt={__name:"ListView",props:{loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},items:{type:Array,default:()=>[]},schema:{type:Object,default:null},hasMore:{type:Boolean,default:!1}},emits:["deleteItem","loadMore"],setup(e,{emit:t}){const l=U(),u=e,i=t,f=v(()=>(u.items.length===0||!u.schema)&&!u.loading),g=()=>{l.push("/add")},d=_=>{i("deleteItem",_)};return(_,I)=>(r(),n("div",Ht,[e.loading||!e.schema||e.items.length===0?(r(),k(H,{key:0,count:6,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"})):e.schema&&e.items.length>0?(r(),n("div",Gt,[s("div",Qt,[(r(!0),n(F,null,$(e.items,C=>(r(),k(Pt,{key:C.id,item:C,schema:e.schema,onDeleteItem:d},null,8,["item","schema"]))),128)),e.loadingMore?(r(),k(H,{key:0,count:3,class:"contents"})):x("",!0)])])):f.value?(r(),k(Et,{key:2,onAddItem:g})):x("",!0),e.hasMore&&!e.loading?(r(),k(Se,{key:3,loading:e.loadingMore,onLoadMore:_.loadMore},null,8,["loading","onLoadMore"])):x("",!0)]))}},Jt={class:"home-view"},Kt={class:"space-y-8"},Xt={__name:"HomeView",setup(e){const t=le(),l=v(()=>t.loading),u=v(()=>t.error),i=v(()=>t.items),f=v(()=>{if(!t.schema?.properties)return null;const b=t.getDatabaseInfo()?.schema?.properties||{};return{...t.schema,properties:Object.fromEntries(Object.entries(t.schema.properties).map(([L,w])=>[L,{...w,type:w.type,required:w.required||!1,emoji:w.emoji||null,icon:w.icon||null,number:w.number||null,select:w.select||null,multi_select:w.multi_select||null,...b[L]&&{number:{...w.number,format:b[L].number?.format||w.number?.format}}}]))}}),g=M(!1),d=M(""),_=M(""),I=M(!1),C=async()=>{try{const[h,b]=await Promise.allSettled([t.ensureSchemaLoaded(),t.fetchAllItems()]);h.status==="rejected"&&console.error("Schema loading failed:",h.reason),b.status==="rejected"&&console.error("Items loading failed:",b.reason),h.status==="fulfilled"&&b.status==="fulfilled"&&D()}catch(h){console.error("Failed to initialize:",h)}},D=()=>{const h=t.getDatabaseInfo();h&&(h.title&&(d.value=h.title),h.description&&(_.value=h.description))},A=async()=>{try{const[h,b]=await Promise.allSettled([t.fetchSchema(!0),t.fetchAllItems()]);h.status==="fulfilled"&&b.status==="fulfilled"?D():(console.error("Schema refresh failed:",h.status==="rejected"?h.reason:"Unknown error"),console.error("Items refresh failed:",b.status==="rejected"?b.reason:"Unknown error"))}catch(h){console.error("Failed to refresh schema:",h)}},T=async()=>{if(!(!I.value||g.value))try{g.value=!0}catch(h){console.error("Failed to load more:",h)}finally{g.value=!1}},z=async()=>{await C()},P=async h=>{try{await t.deleteItem(h),await t.fetchAllItems()}catch(b){console.error("Failed to delete item:",b)}};return ue(()=>{C()}),(h,b)=>(r(),n("div",Jt,[s("div",Kt,[S(be,{loading:l.value,"database-title":d.value,"database-description":_.value,onRefreshSchema:A},null,8,["loading","database-title","database-description"]),S(_e,{error:u.value,onRetry:z},null,8,["error"]),S(Wt,{loading:l.value,"loading-more":g.value,items:i.value,schema:f.value,"has-more":I.value,onDeleteItem:P,onLoadMore:T},null,8,["loading","loading-more","items","schema","has-more"])])]))}},ss=ae(Xt,[["__scopeId","data-v-5925e735"]]);export{ss as default};
